define("shared/masthead/templates",["underscore/nyt"],function(_){var templates={};return templates.profileIcon=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<span class="avatar" role="presentation">\n<a href="javascript:;" class="user-profile-button"><img src="'+(null==(__t=userData.getImageUrl())?"":__t)+'" alt="" /></a>\n</span>';return __p},templates.userName=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<button class="button user-name-button">\n<span class="button-text">'+(null==(__t=getTruncatedUserName(15))?"":__t)+'</span>\n<i class="icon sprite-icon user-icon"></i>\n<i class="icon caret-icon"></i>\n</button>';return __p},templates.userNameModalContent=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<ul>\n<li><a href="javascript:;" class="user-profile-button">Edit Profile</a></li>\n<li><a href="'+(null==(__t=hosts.myaccount)?"":__t)+'/membercenter/myaccount.html">My Account</a></li>\n<li><a href="'+(null==(__t=hosts.myaccount)?"":__t)+'/mem/manage_billing.html">My Billing Information</a></li>\n<li><a href="'+(null==(__t="http:"+hosts.www)?"":__t)+'/saved">My Saved Items</a></li>\n<li><button class="button log-out-button">Log Out</button></li>\n</ul>';return __p},templates.userNameModalTitle=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="",""!=userData.getImageUrl()&&(__p+='<span class="avatar">\n<a href="javascript:;" class="user-profile-button"><img src="'+(null==(__t=userData.getImageUrl())?"":__t)+'" /></a>\n</span>'),__p+='\n<span class="user-name-subscription">\n<span class="user-name">'+(null==(__t=userData.getUserName())?"":__t)+'</span>\n<span class="user-subscription"><a href="https://myaccount.nytimes.com/membercenter/myaccount.html">'+(null==(__t=subscription.label)?"":__t)+"</a></span>\n</span>";return __p},templates.userSettingsModal=function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<div class="menu edition-menu">\n<h5 class="modal-heading">Edition</h5>\n<ul>\n',__p+=internationalEditionFlag?'\n<li><a href="http://www.nytimes.com" data-edition="us">English</a></li>\n':'\n<li><a href="http://www.nytimes.com" data-edition="us">U.S.</a></li>\n<li><a href="http://global.nytimes.com" data-edition="global">International</a></li>\n',__p+='\n<li><a href="http://cn.nytimes.com" data-edition="chinese">中文 (Chinese)</a></li>\n<li><a href="http://www.nytimes.com/es/" data-edition="spanish">Español</a></li>\n</ul>\n</div>\n<div class="menu help-menu">\n<h5 class="modal-heading">Help</h5>\n<ul>\n<li><a href="http://www.nytimes.com/content/help/front.html">FAQ</a></li>\n<li><a href="http://www.nytimes.com/content/help/contact/directory.html">Contact Us</a></li>\n</ul>\n</div>\n',showTypeSizer&&(__p+='\n<div class="menu type-sizer-menu">\n<h5 class="modal-heading">Type Size</h5>\n<ul>\n<li data-size="small" class="type-sizer-small"><a href="javascript:;">A <span class="visually-hidden">Type size small</span></a></li>\n<li data-size="medium" class="type-sizer-medium"><a href="javascript:;">A <span class="visually-hidden">Type size medium</span></a></li>\n<li data-size="large" class="type-sizer-large"><a href="javascript:;">A <span class="visually-hidden">Type size large</span></a></li>\n</ul>\n</div>\n'),__p+="";return __p},templates}),define("shared/masthead/views/masthead",["jquery/nyt","underscore/nyt","foundation/views/base-view","foundation/models/user-data","shared/masthead/templates"],function(e,t,i,a,n){"use strict";var s=i.registerView("masthead").extend({el:"#masthead",events:{"click .home-button":"handleHomeClick","click .search-button":"handleSearchClick","click .sections-button":"handleSectionsClick","click .branding a":"handleLogoClick","click .story-meta .nyt-logo":"handleLeftLogoClick","click .editions-menu a":"handleEditionClick","click .login-button":"handleLogInClick","click .subscribe-button":"handleSubscribeClick"},nytEvents:{"nyt:ribbon-visiblility":"accomodateRibbon","nyt:masthead-search-toggle":"handleSearchToggle","nyt:messaging-critical-alerts-move-furniture":"handlePageAlerts","nyt:messaging-suggestions-move-furniture":"handlePageAlerts","nyt:messaging-notification-count-update":"handleMessagingCountChange","nyt:masthead-edition-change":"handleEditionClick"},initialize:function(){this.trackingBaseData={action:"click",contentCollection:this.pageManager.getMeta("article:section"),region:"TopBar"}},handleUserReady:function(){var e=this.$el.find(".user-tools-button-group");a.isLoggedIn()?e.prepend(n.userName(a)):(this.pageManager.hasAdBlock().done(function(){e.find(".subscribe-button").removeClass("hidden")}),e.find(".login-button").removeClass("hidden"))},accomodateRibbon:function(e){e?(this.$el.addClass("ribbon-visible"),this.$el.find(".update-text").css("display","inline-block")):(this.$el.find(".update-text").css("display","none"),this.$el.removeClass("ribbon-visible"))},handlePageAlerts:function(e){e(this.$el)},handleHomeClick:function(t){var i,a;i=e(t.currentTarget).closest(".home-button"),a=this.trackingAppendParams(i.data("href"),{module:"HomePage-Button"}),window.location=a},handleSearchClick:function(e){this.broadcast("nyt:masthead-search-click",e),this.trackingTrigger("masthead-search-click",{module:"SearchOpen",eventName:"OpenSearchBar"})},handleSectionsClick:function(e){this.broadcast("nyt:masthead-section-click",e)},handleLogoClick:function(t){var i,a;i=e(t.currentTarget),a=this.trackingAppendParams(i.attr("href"),{module:"HomePage-Title"}),i.attr("href",a)},handleLeftLogoClick:function(t){var i,a;i=e(t.currentTarget).parent("a"),a=this.trackingAppendParams(i.attr("href"),{module:"HomePage-Left-Title"}),i.attr("href",a)},handleSearchToggle:function(e){this.$el.find(".search-button")[e?"addClass":"removeClass"]("active")},handleMessagingCountChange:function(e){var t=this.$el.find(".notifications-button"),i=e.count>99?"99+":e.count;t.find(".button-text").html(i),e.delta>0?(t.addClass("has-notifications animate-notifications"),setTimeout(function(){t.removeClass("animate-notifications")},2e3)):0===e.count&&t.removeClass("has-notifications")},handleEditionClick:function(t){var i=e(t.target),a=i.data("edition"),n=i.attr("href"),s="";switch(this.pageManager.setEdition(a),a){case"us":s="EditionToggleToUS";break;case"global":s="EditionToggleToGlobal";break;case"chinese":s="EditionToggleToCHNS";break;case"spanish":s="EditionToggleToSpanish"}n=this.trackingAppendParams(n,{module:s}),i.attr("href",n)},handleLogInClick:function(){var e="masthead-login";this.trackingTrigger("masthead-login-click",{module:"LogIn","WT.nav":"shell"}),this.trackingTrigger("tagx-auth-interaction",{module:e,state:a.isLoggedIn()?"logged in":"logged out",eventName:"login click | "+e})},handleSubscribeClick:function(t){var i,a;i=e(t.currentTarget).closest(".subscribe-button"),a=this.trackingAppendParams(i.data("href"),{module:"Subscribe-Now"}),window.location=a}});return s}),define("shared/masthead/views/masthead-api",["jquery/nyt","foundation/views/base-view"],function(e,t){"use strict";var i=t.extend({el:"#masthead",position:"fixed",inStory:!1,nytEvents:{"nyt:ad-library:adx:ad-rendered":"handleAdRendered"},initialize:function(){this.$container=e(".container"),this.$ribbon=e(".ribbon"),this.inStoryHeight=this.$el.height()},hide:function(){this.$el.hide(),this.$ribbon.addClass("no-masthead")},show:function(){this.$el.show(),this.$ribbon.removeClass("no-masthead")},getElement:function(){return this.$el},swap:function(e){this.$el.find(".container").hide(),e&&(this.$emptyMasthead||(this.$el.append('<div class="empty-masthead"></div>'),this.$emptyMasthead=this.$el.find(".empty-masthead")),this.$emptyMasthead.html(e))},restore:function(){this.$el.find(".container").show(),this.$el.find(".empty-masthead").remove(),this.$emptyMasthead=!1,this.$el.removeAttr("style"),this.$ribbon.css("margin-top","").removeClass("no-masthead"),this.$container.css("min-height",""),this.inStoryHeight=this.$el.height()},setHeight:function(e){if(!e||"number"!=typeof e)throw new Error("Masthead API - setHeight requires a number as an argument");this.inStoryHeight=e,this.$el.css("height",e),this.$container.css("min-height",e),this.$ribbon.css("margin-top",e),"absolute"===this.$el.css("position")&&this.$el.css("margin-top",-e)},setPosition:function(e){if("fixed"===e)this.$el.css({position:"fixed","margin-top":"0"}),this.broadcast("nyt:masthead-fixed");else{if("absolute"!==e)throw new Error('Masthead API - setPosition only accepts "absolute" or "fixed" as arguments');this.$el.css({position:"absolute","margin-top":-this.inStoryHeight+1,right:0,width:"auto"}),this.$ribbon.addClass("no-masthead"),this.broadcast("nyt:masthead-absolute")}},set:function(e){if(!e||"object"!=typeof e)throw new Error("Masthead API - set method requires an object as an argument");e.height&&this.setHeight(e.height),e.position&&this.setPosition(e.position),e.content&&this.swap(e.content),e.change&&this.change(e.change)},change:function(e){var t=this;if(!e||"function"!=typeof e)throw new Error("Masthead API - change method requires a function as an argument");this.subscribe("nyt:masthead-storytheme",function(i){t.inStory=i,e(i)})},isInStory:function(){return this.inStory},renderedAds:[],handleAdRendered:function(e){this.renderedAds.push(e)},returnRenderedAds:function(){return this.renderedAds}});return i}),define("shared/masthead/instances/masthead-api",["shared/masthead/views/masthead-api"],function(e){"use strict";return new e}),define("shared/masthead/views/in-story-theme",["jquery/nyt","underscore/nyt","foundation/views/base-view","foundation/views/page-manager","foundation/models/user-data","shared/masthead/instances/masthead-api"],function(e,t,i,a,n,s){"use strict";var o=i.extend(t.extend({},s,{el:"#masthead",events:{"click .kicker":"scrollToTop","click .kicker-label a":"handleSectionClick","click #nyt-button-sub":"trackSubscribeClick","click #subscribe_small":"trackSubscribeClick"},nytEvents:{"nyt:page-scroll":"toggleTheme","nyt:page-scroll-after":"setSwitchPosition","nyt:page-resize":"handleResize","nyt:page-breakpoint":"handleBreakPoint","nyt:masthead-switch-change":"handleSwitchChange","nyt:masthead-position-change":"handlePositionChange"},defaultSettings:{themeClass:"in-content",switchPosition:0,shouldScrollAway:!1,currentBreakPoint:a.getCurrentBreakpoint(),metaContainer:".story-meta",contentSelector:"#story",contentSwitchPointSelector:".story-meta .kicker"},initialize:function(e){this.settings=t.extend({},this.defaultSettings,e),this.viewportSmall=100,this.viewportMedium10=1010},handleDomReady:function(){this.isTransparent()?this.setSwitchOverrides("#story .story-body-text",!0):this.$switchSelector=e("#story").find(".story-meta .kicker"),this.$pageContainer=this.$el.find(".container"),this.$mastheadKicker=this.$el.find(".kicker"),this.setSwitchPosition(),this.toggleTheme(),this.checkAdsRendered(this.returnRenderedAds())},handleSwitchChange:function(e,t){this.setSwitchOverrides(e,t)},handlePositionChange:function(e){this.settings.shouldScrollAway=e||!1,e||this.$el.css("position","fixed"),this.toggleTheme()},handleResize:function(){a.isDomReady()&&(this.isTransparent()?this.setSwitchOverrides("#story .story-body-text",!0):this.$switchSelector=e("#story").find(".story-meta .kicker"),this.moveMastheadKicker(),this.bar1IsRendered?this.fixedNavSubscribe():this.checkAdsRendered(this.returnRenderedAds()),this.settings.currentBreakPoint<this.viewportSmall?this.removeStoryTheme():this.toggleTheme())},handleUserReady:function(){!n||n.isHomeDeliverySubscriber()||n.isWebSubscriber()||n.isMobileSubscriber()||n.isTabletSubscriber()||(this.userNotSub=!0,this.fixedNavSubscribe())},checkAdsRendered:function(e){var i=this;t.each(e,function(e){"Bar1"==e&&(i.bar1IsRendered=!0,i.fixedNavSubscribe())})},setSwitchOverrides:function(t,i){this.settings.shouldScrollAway=i||!1,this.$switchSelector=e(t),this.setSwitchPosition(!0),this.toggleTheme()},setSwitchPosition:function(e){this.$switchSelector.length>0&&(this.settings.switchPosition=this.$switchSelector.offset().top-this.$el.height()),e===!0&&(this.settings.overridePosition=this.settings.switchPosition)},toggleTheme:function(){var e,t,i,n,s,o=this.settings.overridePosition||100;this.settings.switchPosition<o&&(this.settings.switchPosition=o),e=a.getViewport().top,t=e>this.settings.switchPosition,i=e>o,n=this.$el.hasClass(this.settings.themeClass),s="nyt:masthead-storytheme",t&&!n&&this.settings.currentBreakPoint>=this.viewportSmall?(this.settings.shouldScrollAway===!0&&this.$el.css("position","fixed"),this.$el.find(".sections-button").hasClass("mobile-navigation-active")||this.addStoryTheme(),this.removeSmallCommentButton(),this.broadcast(s,!0)):!i&&n?(this.settings.shouldScrollAway===!0&&this.$el.css("position","absolute"),this.removeStoryTheme(),this.removeExtraSmallCommentButton(),this.broadcast(s,!1)):n||this.settings.shouldScrollAway!==!0||this.$el.css("position","absolute")},addStoryTheme:function(){this.isTransparent()||this.$el.find(".branding").fadeOut(300).end().addClass(this.settings.themeClass),this.$el.find(".comments-button").removeClass("theme-speech-bubble-x-small").addClass("theme-speech-bubble-small"),this.settings.currentBreakPoint>=this.viewportMedium10&&this.$el.find(this.settings.metaContainer).fadeIn(300),this.$el.addClass(this.settings.themeClass),this.moveMastheadKicker(),this.bar1IsRendered?this.fixedNavSubscribe():this.checkAdsRendered(this.returnRenderedAds())},removeStoryTheme:function(){this.isTransparent()||this.$el.find(".branding").stop(!1,!0).show().end().removeClass(this.settings.themeClass),this.$el.find(".comments-button").removeClass("theme-speech-bubble-small").addClass("theme-speech-bubble-x-small"),this.settings.currentBreakPoint>=this.viewportMedium10&&this.$el.find(this.settings.metaContainer).stop().hide(),this.bar1IsRendered?this.fixedNavSubscribe():this.checkAdsRendered(this.returnRenderedAds()),this.$el.removeClass(this.settings.themeClass)},fixedNavSubscribe:function(){var e=window.NYTD&&window.NYTD.Abra&&window.NYTD.Abra("www-fixed-nav-subscribe-test"),t=this.$el.find("#nyt-button-sub").children();e&&"1"===window.NYTD.Abra("www-fixed-nav-subscribe-test")&&this.userNotSub&&(this.$el.hasClass(this.settings.themeClass)&&this.$el.not(".fixed-nav-subscribe")&&(this.trackSubscribeImpressionOnce(),this.$el.addClass("fixed-nav-subscribe")),this.pageManager.getViewport().width>=this.viewportMedium10&&this.$el.hasClass(this.settings.themeClass)?this.$el.find("#nyt-button-sub").html("Subscribe").append(t):this.pageManager.getViewport().width>=this.viewportMedium10&&!this.$el.hasClass(this.settings.themeClass)&&this.$el.find("#nyt-button-sub").html("SUBSCRIBE NOW").append(t))},trackSubscribeImpressionOnce:function(){this.trackedImpression||this.trackingTriggerImpression("fixed-nav-subscribe",{module:"fixed-nav-subscribe",action:"impression"}),this.trackedImpression=!0},trackSubscribeClick:function(){this.trackingTriggerRaw("fixed-nav-subscribe",{module:"fixed-nav-subscribe",action:"click",eventName:"subscribe"},"interaction")},removeSmallCommentButton:function(){this.isTransparent()&&this.$el.find(".theme-speech-bubble-small .button-meta").remove()},removeExtraSmallCommentButton:function(){this.isTransparent()&&this.$el.find(".theme-speech-bubble-x-small .icon").remove()},moveMastheadKicker:function(){var e;this.$mastheadKicker&&"collection"!==this.pageManager.getApplicationName()&&(e=this.$pageContainer.width()-1375,this.settings.currentBreakPoint>=10050&&this.settings.currentBreakPoint<10070&&e>0?this.$mastheadKicker.css({"margin-left":Math.floor(e/2)+"px"}):this.settings.currentBreakPoint>=10070?this.$mastheadKicker.css("margin-left","138px"):this.settings.currentBreakPoint<10050&&this.$mastheadKicker.css("margin-left","0px"))},scrollToTop:function(t){var i=e(t.target);i.is("a")||i.parent().is("a")||e("html, body").animate({scrollTop:0},400)},handleBreakPoint:function(e){this.settings.currentBreakPoint=e},isTransparent:function(){return this.$el.is(".masthead-theme-transparent, .masthead-theme-transparent-ffffff")},handleSectionClick:function(t){var i=e(t.currentTarget),a=this.trackingAppendParams(i.attr("href"),{module:"SF-FixedNav",action:"click",contentCollection:this.pageManager.getMeta("article:section"),region:"TopBar"});i.attr("href",a)}}));return o}),define("shared/searchform/models/search-suggest",["foundation/models/base-model"],function(e){"use strict";var t=e.extend({defaults:{query:"",results:[]}});return t}),define("shared/searchform/collections/search-suggest",["backbone/nyt","foundation/collections/base-collection","foundation/views/page-manager","shared/searchform/models/search-suggest","foundation/hosts"],function(e,t,i,a,n){"use strict";var s=t.extend({model:a,mobileBaseUrl:n.mobileWeb,desktopBaseUrl:n.www,settings:{numOfSuggestions:7},query:"",sync:function(t,i,a){var n="/svc/suggest/v1/homepage?query="+this.query;return this.pageManager.getCurrentBreakpoint()<120?a.url=this.mobileBaseUrl+n:a.url=this.desktopBaseUrl+n,e.sync(t,i,a)},parse:function(e){return{query:e[0],results:e[1].slice(0,this.settings.numOfSuggestions)}},newQuery:function(e){this.query=e,this.fetch()}});return s}),define("shared/searchform/templates",["underscore/nyt"],function(_){var templates={};return templates.autoSuggest=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<li><a href="'+(null==(__t=queryUrl)?"":__t)+'">\n'+(null==(__t=suggest.replace(queryRegExp,"<strong>"+query+"</strong>"))?"":__t)+"\n</a></li>";return __p},templates}),define("shared/searchform/helpers/search-form-mixin",["jquery/nyt","underscore/nyt","foundation/lib/polyfills/placeholder","shared/searchform/collections/search-suggest","shared/searchform/templates","foundation/hosts"],function(e,t,i,a,n,s){"use strict";var o=t.extend({},{collection:new a,searchBaseUrl:s.search+"/search/sitesearch/#/",searchMobileUrl:s.mobileWeb+"/search?query=",KEYS:{ENTER:13,ESC:27,UP_ARROW:38,DOWN_ARROW:40,LEFT_ARROW:37,RIGHT_ARROW:39},initialize:function(){var e=this.pageManager.getMeta("article:section")||"";t.bindAll(this,"handlePageClicks"),this.trackingBaseData={action:"click",contentCollection:e,region:"TopBar"}},handleDomReady:function(){this.$list=this.$el.find(".auto-suggest"),this.$clearButton=this.$el.find(".clear-button"),this.$overlay=this.$shell.find(".search-overlay"),this.$input=this.$el.find(".search-input"),this.$submitButton=this.$el.find(".submit-button"),this.disableSubmitButton(),this.listenTo(this.collection,"sync change",this.render),this.throttledSuggestions=t.debounce(this.getAutoSuggestions,250),this.afterInitialize()},afterInitialize:e.noop,render:function(){var e,t="",i=this.collection.toJSON()[0],a=new RegExp(i.query,"ig"),s=n.autoSuggest,o=i.results.length;if(o>0&&this.getSearchValue().length>0){for(e=0;o>e;e+=1)t+=s({query:i.query,queryUrl:this.getSearchUrl(i.results[e]),suggest:i.results[e],queryRegExp:a});this.$list.show().find("ol").html(t)}else this.$list.hide()},handleKeyDown:function(e){var t=e.which;t===this.KEYS.ENTER&&e.preventDefault()},handleKeyUp:function(e){var t=e.which;e.preventDefault(),t===this.KEYS.UP_ARROW||t===this.KEYS.DOWN_ARROW?this.navigateAutoSuggestions(t):t===this.KEYS.ENTER?this.handleEnterKey(e):t===this.KEYS.RIGHT_ARROW||t===this.KEYS.LEFT_ARROW?this.handleRightLeftKey(e):(this.$clearButton[this.getSearchValue().length>0?"fadeIn":"fadeOut"](200),this.getSearchValue().length?this.$submitButton.hasClass("disabled")&&this.$submitButton.removeClass("disabled"):this.disableSubmitButton(),this.throttledSuggestions())},handleEnterKey:function(){this.submitSearch()},handleRightLeftKey:e.noop,handleClearButton:function(e){e.preventDefault(),this.setSearchValue(""),this.$clearButton.fadeOut(200),this.disableSubmitButton(),this.$input.focus(),i()},setSearchValue:function(e){this.$input.val(e)},getSearchValue:function(){return e.trim(this.$input.val())},hideAutoSuggest:function(){this.$list.hide()},getAutoSuggestions:function(){var e=this.getSearchValue();e.length>1?this.collection.newQuery(e):this.hideAutoSuggest()},getSearchUrl:function(e){return this.pageManager.getCurrentBreakpoint()<120?this.searchMobileUrl+e+"&sort=rel":this.searchBaseUrl+e},navigateAutoSuggestions:function(e){var t,i;i=this.$list.find(".active"),t=i.parent().index()||0,t+=e===this.KEYS.UP_ARROW?-1:1,this.$list.find("a").removeClass("active").eq(t).addClass("active"),this.setSearchValue(this.$list.find("a").eq(t).text())},submitSearch:function(e){var t,i=this.getSearchValue();e&&e.preventDefault(),i&&(t=this.trackingAppendParams(this.getSearchUrl(i),{module:"SearchSubmit"}),this.$el.is(":visible")&&(window.location=t))},handlePageClicks:function(){this.hideAutoSuggest()},disableSubmitButton:function(){this.$submitButton.addClass("disabled")}});return o}),define("shared/masthead/views/search",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/searchform/helpers/search-form-mixin"],function(e,t,i,a){"use strict";var n=i.extend(t.extend({},a,{el:e("#masthead").find(".search-flyout-panel"),events:{"click .close-button":"close","keyup .search-input":"handleKeyUp","keydown .search-input":"handleKeyDown","click .submit-button":"submitSearch","click .clear-button":"handleClearButton"},nytEvents:{"nyt:masthead-search-click":"toggle","nyt:masthead-search-toggle":"handleSearchToggle","nyt:navigation-search-click":"toggle","nyt:search-close-ready":"close"},slideTiming:100,afterInitialize:function(){this.trackingBaseData["WT.nav"]="searchWidget",this.$input.removeAttr("placeholder")},open:function(){var e=this;this.$el.slideDown(this.slideTiming,function(){e.$el.find(".control").fadeIn(e.slideTiming).end().find(".search-input").val("").focus()}),this.broadcast("nyt:masthead-search-toggle",!0),this.$shell.on("click",this.handlePageClicks),this.subscribeOnce("nyt:page-key-esc",this.close),this.$overlay.fadeIn(200),this.$html.addClass("search-active")},close:function(){var e=this;this.$html.hasClass("search-active")&&(this.$el.find(".control").fadeOut(this.slideTiming,function(){e.$el.slideUp(e.slideTiming,function(){e.$html.removeClass("search-active")})}),this.broadcast("nyt:masthead-search-toggle",!1),this.$shell.off("click",this.handlePageClicks),this.setSearchValue(""),this.$overlay.fadeOut(200))},toggle:function(){this[this.$el.is(":visible")?"close":"open"]()},isSearchButton:function(t){var i=e(t).hasClass("search-button"),a=1===e(t).parents(".search-button").length;return i||a},isSearchFlyout:function(t){var i=e(t).hasClass("search-flyout-panel"),a=1===e(t).parents(".search-flyout-panel").length;return i||a},handlePageClicks:function(e){this.isSearchButton(e.target)||this.isSearchFlyout(e.target)||this.close(),this.hideAutoSuggest()},handleSearchToggle:function(e){e===!1&&(this.$el.find(".submit-button").addClass("disabled"),this.$el.find(".clear-button").hide())}}));return n}),define("shared/modal/templates",["underscore/nyt"],function(_){var templates={};return templates.modal=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="overlay"></div>\n<div class="modal '+(null==(__t=id)?"":__t)+" "+(null==(__t=addlClasses)?"":__t)+'" style="'+(null==(__t=modalStyles)?"":__t)+'" role="dialog" aria-labelledby="'+(null==(__t=id)?"":__t)+'-modal-heading" tabindex="-1">\n<div class="modal-header">\n<h3 class="modal-heading" id="'+(null==(__t=id)?"":__t)+'-modal-heading">'+(null==(__t=modalTitle)?"":__t)+"</h3>\n"+(null==(__t=headerContent)?"":__t)+'\n</div>\n<div class="modal-content">\n'+(null==(__t=modalContent)?"":__t)+'\n</div>\n<div class="modal-footer">\n'+(null==(__t=modalFooter)?"":__t)+'\n</div>\n<button type="button" class="modal-close '+(null==(__t=closeClass)?"":__t)+'" aria-disabled="false"><i class="icon"></i><span class="visually-hidden">Close this modal window</span></button>\n<div class="modal-pointer '+(null==(__t="modal-pointer-"+tailDirection)?"":__t)+'"><div class="modal-pointer-conceal"></div></div>\n</div>';return __p},templates}),define("shared/modal/views/modal",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/templates"],function(e,t,i,a){"use strict";var n=i.registerView("modal").extend({template:a.modal,className:"modal-container",events:{"click .modal-close, .modal-pointer, .dismiss-button":"close","mouseenter .modal":"handleMouseOutClose"},defaultSettings:{id:"default-modal",modalTitle:"",headerContent:"",modalContent:"",modalFooter:"",addlClasses:"",binding:"",disableBindings:!1,tailDirection:"down",tailTopOffset:0,tailLeftOffset:0,fixedOverride:!1,hasOverlay:!1,hasCloseButton:!1,canOpenOnHover:!1,closeOnMouseOut:!1,mouseOutDelay:0,mouseEnterDelay:0,closeOnClick:!0,autoPosition:!1,positionTailSide:!1,toggleSpeed:300,focusOnShow:!0,closeOnEsc:!0},initialize:function(e){t.bindAll(this,"close","open","mouseEnterOpen","mouseOutClose","handleClickClose","removeFromPage"),this.settings=t.extend({},this.defaultSettings,e),this.settings.modalStyles="width: "+e.width+";",this.render()},render:function(){var e=this.settings.id+"-container";return this.settings.closeClass=this.settings.hasCloseButton?"":"hidden",this.$el.hide().addClass(e).html(this.template(this.settings)),this.$modal=this.$el.find(".modal"),this.$el.find(".overlay").toggle(this.settings.hasOverlay),this},addToPage:function(e,t){var i="string"==typeof e?this.$body.find(e):this.$body;return t="function"==typeof i[t]?t:"append",i[t](this.$el),""===this.settings.binding||this.settings.disableBindings||(this.$body.on("click",this.settings.binding,this.open),this.settings.canOpenOnHover&&(this.$body.on("mouseenter",this.settings.binding,this.mouseEnterOpen),this.$body.on("mouseleave",this.settings.binding,this.mouseOutClose))),this},removeFromPage:function(){return this.close(),this.$el.remove(),""===this.settings.binding||this.settings.disableBindings||(this.$body.off("click",this.settings.binding,this.open),this.settings.canOpenOnHover&&(this.$body.off("mouseenter",this.settings.binding,this.mouseEnterOpen),this.$body.off("mouseleave",this.settings.binding,this.mouseOutClose))),this.remove()},updateTemplate:function(e){return this.$modal.find(".modal-content").html(e),this.positionDialog(!1),this},updateModalTitle:function(e){this.$modal.find(".modal-heading").html(e)},open:function(t){var i=this;return t?(t.returnValue=!1,t.preventDefault(),this.$target=e(t.currentTarget)):this.$target=e(this.settings.binding).eq(0),this.$el.fadeIn(this.settings.toggleSpeed,function(){i.broadcast("nyt:modal-show"),i.broadcast("nyt:modal-show-"+i.settings.id)}),this.settings.autoPosition?this.autoPosition():this.positionDialog(!0),(this.settings.openCallback||e.noop).call(this),this.subscribe("nyt:page-resize",this.positionDialog),this.settings.closeOnEsc&&this.subscribeOnce("nyt:page-key-esc",this.close),this.$body.on("click",this.handleClickClose),this.pageManager.isMobile()&&this.$body.css("cursor","pointer"),this.settings.focusOnShow&&this.$modal.focus(),this},mouseEnterOpen:function(e){window.clearTimeout(this.mouseLeaveTimeout),this.mouseEnterTimeout=t.delay(this.open,this.settings.mouseEnterDelay,e)},close:function(t){var i=this;return t&&t.currentTarget&&this.settings.disableBindings&&e(t.currentTarget).hasClass("modal-pointer")?this:(this.$el.fadeOut(this.settings.toggleSpeed,function(){(i.settings.closeCallback||e.noop).call(i),i.broadcast("nyt:modal-hide"),i.broadcast("nyt:modal-hide-"+i.settings.id)}),this.stopSubscribing("nyt:page-resize",this.positionDialog),this.$body.off("click",this.handleClickClose),window.clearTimeout(this.mouseEnterTimeout),this.pageManager.isMobile()&&this.$body.css("cursor",""),this)},mouseOutClose:function(t){var i=e(t.relatedTarget);i.is(this.$.target)||this.$modal.has(i).length>0||(window.clearTimeout(this.mouseEnterTimeout),this.$modal.is(":visible")&&(this.mouseLeaveTimeout=window.setTimeout(this.close,this.settings.mouseOutDelay)))},handleMouseOutClose:function(){this.settings.closeOnMouseOut&&this.$modal.on("mouseleave",this.close)},handleClickClose:function(e){this.settings.closeOnClick&&0===this.$modal.has(e.target).length&&this.$modal[0]!==e.target&&this.close()},positionDialog:function(t){var i,a,n,s,o,r=this.pageManager.getViewport(),l=this.$target,d=this.$modal,h="absolute",c=d.outerHeight(),u=d.outerWidth(),m={marginLeft:"0",marginTop:"0",top:"",left:""};switch(l&&l.length>0&&(s=l.outerHeight(),o=l.outerWidth(),a=l.offset().top+this.settings.tailTopOffset,n=l.offset().left+this.settings.tailLeftOffset),this.settings.tailDirection){case"up":m.top=a+s+14,m.left=n+Math.floor(.5*o)-Math.floor(.5*u)-9;break;case"up-right":m.top=a+s+14,m.left=n+Math.floor(.5*o)-(u-25);break;case"up-left":m.top=a+s+14,m.left=n+Math.floor(.5*o)-25;break;case"down":m.top=a-c-15,m.left=n+Math.floor(.5*o)-Math.floor(.5*u)-8;break;case"down-right":m.top=a-c-15,m.left=n+Math.floor(.5*o)-(u-25);break;case"down-left":m.top=a-c-15,m.left=n+Math.floor(.5*o)-25;break;case"left":m.top=a+Math.floor(.5*s)-Math.floor(.5*c)+5,this.pageManager.isMobile()&&this.$html.hasClass("navigation-active")?m.left=n+o:m.left=n+o+15;break;case"left-bottom":m.top=a+Math.floor(.5*s)-(c-25),m.left=n+o+15;break;case"left-top":m.top=a+Math.floor(.5*s)-25,m.left=n+o+15;break;case"right":m.top=a+Math.floor(.5*s)-Math.floor(.5*c)+5,m.left=n-u-16;break;case"right-bottom":m.top=a+Math.floor(.5*s)-(c-25),m.left=n-u-16;break;case"right-top":m.top=a+Math.floor(.5*s)-25,m.left=n-u-16;break;case"centered":i=r.height,m.top=c>i?r.top+5:Math.floor(.5*(i-c))+r.top,m.left=Math.floor(.5*r.width-.5*u);break;case"fixed":default:h="fixed",u=this.settings.width||d.width(),c=this.settings.height||d.height(),m.top="50%",m.left="50%",m.marginLeft=-Math.floor(.5*u)+this.settings.tailLeftOffset+"px",m.marginTop=-Math.floor(.5*c)+this.settings.tailTopOffset+"px"}return l&&"fixed"===l.css("position")||this.settings.fixedOverride?(h="fixed",m.top-=r.top,this.$el.css("position","fixed")):this.$el.css("position",""),m.top+=e.isNumeric(m.top)?"px":"",m.left+=e.isNumeric(m.left)?"px":"",d.css("position",h),t===!0?d.css(m):d.stop().animate(m,"fast"),this},autoPosition:function(){var e,t,i,a=this.pageManager.getViewport(),n=this.$modal.outerHeight(),s=this.$modal.outerWidth();return this.settings.positionTailSide&&(i=this.$target.offset().left>a.width/2,this.settings.tailDirection=i?"right":"left"),this.positionDialog(!0),e=this.$target.offset(),this.settings.positionTailSide?(t=this.settings.tailDirection,e.top-a.top-.5*n<0?t+="-top":e.top-a.top+.5*n>a.height&&n-42<e.top-a.top&&(t+="-bottom")):(t=e.top-n<0?"up":"down",e.left+s>a.width?t+="-right":e.left<0&&(t+="-left")),this.$modal.find(".modal-pointer").attr("class","modal-pointer modal-pointer-"+t),this.settings.tailDirection=t,this.positionDialog(!0),this}});return n}),define("shared/masthead/views/user-settings-modal",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/views/modal","shared/masthead/templates"],function(e,t,i,a,n){"use strict";var s=i.extend({events:{"click .edition-menu a":"handleEditionClick","click .type-sizer-menu li":"handleFontSizeClick","click .help-menu a":"handleHelpMenuClick"},nytEvents:{"nyt:fontsizer-initialize":"handleFontSizeChange","nyt:fontsizer-change":"handleFontSizeChange"},defaultSettings:{id:"user-settings-modal",binding:".user-settings-button",tailDirection:"up-right",tailTopOffset:-8,tailLeftOffset:-1,width:"260px",toggleSpeed:1,showTypeSizer:!0,internationalEditionFlag:!1,openCallback:function(){this.$target.addClass("active"),this.subscribeOnce("nyt:page-scroll",this.close)},closeCallback:function(){this.$target.removeClass("active")}},webTrendsNav:"user-settings-modalContainer",initialize:function(e){var i=this.pageManager.getMeta("article:section")||"";this.settings=t.extend({},this.defaultSettings,e),this.settings.modalContent=n.userSettingsModal({showTypeSizer:this.settings.showTypeSizer,internationalEditionFlag:this.pageManager.flag("removeInternationalEdition")}),this.trackingBaseData={action:"click",region:"TopBar","WT.nav":this.webTrendsNav,contentCollection:i}},handleDomReady:function(){
this.render()},render:function(){var e=new a(this.settings);this.setElement(e.$modal),e.$modal.find("a[data-edition="+this.pageManager.getEdition()+"]").addClass("selected"),e.addToPage(),this.handleFontSizeChange()},handleEditionClick:function(e){this.broadcast("nyt:masthead-edition-change",e,{"WT.nav":this.webTrendsNav})},handleHelpMenuClick:function(t){var i=e(t.target),a=i.attr("href");a&&(a=this.trackingAppendParams(a,{}),i.attr("href",a))},handleFontSizeClick:function(t){var i=e(t.currentTarget).data("size");this.broadcast("nyt:fontsizer-change",i)},handleFontSizeChange:function(e){var t="type-size-selected";e=e||this.pageManager.getMeta("fontsizer_typeSize"),this.$el.find(".type-sizer-menu li").removeClass(t),this.$el.find(".type-sizer-"+e).addClass(t)}});return s}),define("shared/account/templates",["underscore/nyt"],function(_){var templates={};return templates.accountModalHeader=function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<h4 class="modal-subheading">To save articles or get newsletters, alerts or recommendations &ndash; all free.</h4>';return __p},templates.logInModalContent=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="buttons">\n'+(null==(__t=oauthButtons)?"":__t)+'\n</div><!-- close buttons -->\n<div class="separator">\n<span class="separator-text">OR</span>\n</div>\n<div class="login-form-control form-control">\n<form id="login-form" class="login-form" role="form" method="post" action="'+(null==(__t=loginUrl)?"":__t)+'">\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="login-email" id="login-email-label">Email address</label>\n</div>\n<div class="field-container">\n<input type="text" id="login-email" name="userid" class="text login-email" placeholder="Email address" aria-labelledby="login-email-label" aria-required="true">\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-email-description"><i class="icon"></i><span class="visually-hidden" id="clear-email-description">Clear this text input</span></button>\n</div>\n</div>\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="login-password" id="login-password-label">Password</label>\n</div>\n<div class="field-container">\n<input type="password" id="login-password" name="password" class="text login-password" placeholder="Password" data-type="password" aria-labelledby="login-password-label" aria-required="true">\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-password-description"><i class="icon"></i><span class="visually-hidden" id="clear-password-description">Clear this text input</span></button>\n</div>\n</div>\n<div class="control user-action-control layout-horizontal">\n<div class="control checkbox-control">\n<div class="field-container">\n<input type="checkbox" id="login-remember-checkbox" name="login-remember" class="checkbox login-remember" checked="checked" aria-labelledby="login-remember-label" aria-checked="true" value="">\n</div>\n<div class="label-container">\n<label for="login-remember" class="checkbox-label" id="login-remember-label">Remember me</label>\n</div>\n</div>\n<p class="form-hint password-hint"><a href="'+(null==(__t=forgotPasswordUrl)?"":__t)+'">Forgot password?</a></p>\n</div>\n<div class="control">\n<p class="disclaimer"><a href="http://www.nytimes.com/content/help/rights/terms/terms-of-service.html">Terms of Service</a> <a href="http://www.nytimes.com/content/help/rights/privacy/policy/privacy-policy.html">Privacy Policy</a></p>\n</div>\n<div class="control button-control">\n<button id="login-send-button" class="button login-button">Log in</button>\n</div>\n<input name="is_continue" value="1" type="hidden">\n<input id="account-form-token" name="token" value="" type="hidden">\n<input id="account-form-expiration" name="expires" value="" type="hidden">\n<input id="login-remember" name="remember" value="1" type="hidden">\n</form>\n</div><!-- close login-form-control -->';return __p},templates.loginModalFooter=function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<p class="user-action registration-modal-trigger">Don&#8217;t have an account? <a href="javascript:;">Sign Up</a></p>';return __p},templates.oauthButtons=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<button id="'+(null==(__t=facebookId)?"":__t)+'" data-provider-name="facebook" class="button oauth-button facebook-oauth-button">\n<i class="icon sprite-icon"></i>\n<span class="button-text">'+(null==(__t=prefix)?"":__t)+' with Facebook</span>\n</button>\n<button id="'+(null==(__t=googleId)?"":__t)+'" data-provider-name="google" class="button oauth-button google-oauth-button">\n<i class="icon sprite-icon"></i>\n<span class="button-text">'+(null==(__t=prefix)?"":__t)+" with Google</span>\n</button>";return __p},templates.registrationModalContent=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="buttons">\n'+(null==(__t=oauthButtons)?"":__t)+'\n</div><!-- close buttons -->\n<div class="separator">\n<span class="separator-text">OR</span>\n</div>\n<div class="registration-form-control form-control">\n<form id="registration-form" class="registration-form" role="form" method="post" action="'+(null==(__t=regiUrl)?"":__t)+'">\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="register-email" id="register-email-label">Email address</label>\n</div>\n<div class="field-container">\n<input type="email" id="register-email" name="email_address" class="text register-email" placeholder="Email address" aria-labelledby="register-email-label" aria-required="true" />\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-email-description"><i class="icon"></i><span class="visually-hidden" id="clear-email-description">Clear this text input</span></button>\n</div>\n</div><!-- close control -->\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="register-password" id="register-password-label">Password</label>\n</div>\n<div class="field-container">\n<input type="password" id="register-password" name="password1" class="text register-password" placeholder="Password" data-type="password" aria-labelledby="register-password-label" aria-required="true" />\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-password-description"><i class="icon"></i><span class="visually-hidden" id="clear-password-description">Clear this text input</span></button>\n</div>\n</div><!-- close control -->\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="retype-password" id="retype-password-label">Retype password</label>\n</div>\n<div class="field-container">\n<input type="password" id="retype-password" name="password2" class="text retype-password" placeholder="Retype password" data-type="password" aria-labelledby="retype-password-label" aria-required="true" />\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-retyped-password-description"><i class="icon"></i><span class="visually-hidden" id="clear-retyped-password-description">Clear this text input</span></button>\n</div>\n</div><!-- close control -->\n<div class="control layout-horizontal">\n<p class="form-hint">\nBy signing up, you agree to receive updates and special offers for The New York Times’s products and services. You may unsubscribe at any time.\n</p>\n</div>\n<div class="control">\n<p class="disclaimer"><a href="http://www.nytimes.com/content/help/rights/terms/terms-of-service.html">Terms of Service</a> <a href="http://www.nytimes.com/content/help/rights/privacy/policy/privacy-policy.html">Privacy Policy</a></p>\n</div>\n<div class="control button-control">\n<button id="register-send-button" class="button register-button">Create Account</button>\n</div>\n<input name="is_continue" value="1" type="hidden">\n<input id="account-form-token" name="token" value="" type="hidden">\n<input id="account-form-expiration" name="expires" value="" type="hidden">\n<input id="account-form-subscribe" name="subscribe[]" type="hidden" value="MM">\n</form>\n</div><!-- close registration-form-control -->';return __p},templates.registrationModalFooter=function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<p class="user-action login-modal-trigger">Already have an account? <a href="javascript:;">Log In</a></p>';return __p},templates.userProfileModalContent=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="user-profile-form-control form-control '+(null==(__t=user?"":"user-profile-form-control-loading")?"":__t)+'">\n',user&&(__p+='\n<form id="user-profile-form" class="user-profile-form" role="form" method="post">\n<div class="controls">\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="user-profile-name" id="user-profile-name-label">Name</label>\n</div>\n<div class="field-container">\n<input type="text" id="user-profile-name" name="name" class="text user-profile-name" placeholder="Name" aria-labelledby="user-profile-name-label" aria-required="true" value="'+(null==(__t=user.getName())?"":__t)+'">\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-name-description"><i class="icon"></i><span class="visually-hidden" id="clear-name-description">Clear this text input</span></button>\n</div>\n</div>\n<div class="control">\n<div class="label-container visually-hidden">\n<label for="user-profile-location" id="user-profile-location-label">Location</label>\n</div>\n<div class="field-container">\n<input type="text" id="user-profile-location" name="location" class="text user-profile-location" placeholder="Location" aria-labelledby="user-profile-location-label" aria-required="true" value="'+(null==(__t=user.getLocation())?"":__t)+'">\n<button type="button" class="button clear-button" tabindex="-1" aria-describedby="clear-location-description"><i class="icon"></i><span class="visually-hidden" id="clear-location-description">Clear this text input</span></button>\n</div>\n</div>\n<div class="control checkbox-control">\n<div class="field-container">\n<input type="checkbox" id="global-comment-notify-checkbox" name="global-comment-notify" class="checkbox comment-notify" '+(null==(__t=user.getNotify()?'checked="checked"':"")?"":__t)+' aria-labelledby="comment-notify-label" aria-checked="true" value="">\n</div>\n<div class="label-container">\n<label for="global-comment-notify" class="checkbox-label" id="global-comment-notify-label">Receive email notifications when your comments are published.</label>\n</div>\n</div>\n<div class="control button-control">\n<button class="button save-button">Save</button>\n<button class="button cancel-button">Cancel</button>\n</div>\n</div>\n<div class="avatar" role="presentation">\n<span class="avatar-image"><img width="80" height="80" src="'+(null==(__t=user.getAvatar())?"":__t)+'"/></span>\n<label class="user-profile-avatar-button" for="user-profile-avatar-input">\nEdit photo\n<input type="file" name="avatar" id="user-profile-avatar-input" class="user-profile-avatar-input"/>\n</label>\n<div class="avatar-editor">\n<div class="avatar-crop"></div>\n<button class="button crop-button">Crop</button>\n</div>\n</div>\n</form>\n'),__p+="\n</div><!-- close user-profile-form-control -->";return __p},templates.userProfileModalHeader=function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<h4 class="modal-subheading">Your profile is public. It will appear with any comments you leave on NYTimes.com</h4>';return __p},templates}),define("shared/account/views/user-profile-modal",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/views/modal","shared/account/templates"],function(e,t,i,a,n){"use strict";var s=i.extend({events:{"change #user-profile-avatar-input":"handleAvatarUpload","click .cancel-button":"handleCancelClick","click .save-button":"handleSaveClick","click .crop-button":"handleCropClick","submit #profile-form":"handleFormSubmit"},defaultSettings:{id:"user-profile-modal",addlClasses:"",headerContent:n.userProfileModalHeader(),modalTitle:"Edit Profile",modalContent:"",binding:".user-profile-button",tailDirection:"fixed",hasCloseButton:!0,hasOverlay:!0,cropBoundaries:{x1:0,y1:0,x2:0,y2:0},tailLeftOffset:-40,tailTopOffset:-40,cropperWidth:80,cropperHeight:80},initialize:function(e){var i=this;this.settings=t.extend({},this.defaultSettings,e),this.settings.openCallback=function(){i.model||require(["shared/community/instances/community-user"],function(e){i.model=e,i.model.isNew()?i.model.once("change",i.render,i):i.render(),i.model.on("avatarFailed",i.render,i)}),this.subscribeOnce(i,"nyt:profile-modal-close",this.close)},this.settings.modalContent=this.renderModalContent()},renderModalContent:function(){return n.userProfileModalContent({user:this.model?this.model:null})},handleUserReady:function(){var e=new a(this.settings);this.setElement(e.$modal),e.addToPage(),e.settings.closeCallback=this.render.bind(this),this.modal=e},render:function(){this.modal&&this.model&&this.modal.updateTemplate(this.renderModalContent())},handleCancelClick:function(e){e.preventDefault(),this.local(this,"nyt:profile-modal-close")},handleSaveClick:function(e){e.preventDefault(),this.model&&(this.model.setName(this.$el.find("#user-profile-name").val()),this.model.setLocation(this.$el.find("#user-profile-location").val()),this.model.setNotify(this.$el.find("#global-comment-notify-checkbox").is(":checked")),this.$(".save-button").addClass("disabled").attr("disabled","disabled"),this.model.once("sync",function(){this.local(this,"nyt:profile-modal-close")},this).save())},handleFormSubmit:function(e){e.preventDefault()},handleAvatarUpload:function(e){this.$(".user-profile-avatar-button").addClass("loading"),this.model&&e.target.files&&this.model.once("avatarUploaded",this.createCropper.bind(this)).addRawAvatar(e.target.files[0])},handleCropClick:function(t){var i=this;t.preventDefault(),e(t.target).addClass("disabled").attr("disabled","disabled"),this.model.once("avatarCropped",function(){i.render()}).cropRawAvatar(this.settings.cropBoundaries)},getCropBoundingBox:function(e,t){var i=Math.abs(parseInt(e.css("left"),10)),a=Math.abs(parseInt(e.css("top"),10)),n={};return n.x1=Math.ceil(i*t),n.y1=Math.ceil(a*t),n.x2=Math.ceil((i+this.settings.cropperWidth)*t),n.y2=Math.ceil((a+this.settings.cropperHeight)*t),n},createCropper:function(t){var i,a=this.$(".avatar-crop"),n=this;return e.fn.draggable?(this.$("#user-profile-form").addClass("avatar-editing"),void(i=e('<img src="'+t+'"/>').on("load",function(){var t,s=this.width>this.height?"avatar-horizontal":"avatar-vertical",o=this.width>this.height?"x":"y",r=this.naturalHeight/a.height();i.removeClass("avatar-horizontal avatar-vertical").addClass(s).css({left:"0px",top:"0px"}),a.empty().append(i),n.settings.cropBoundaries=n.getCropBoundingBox(i,r),t=e('<div class="avatar-crop-container"></div>').prependTo(a).css({height:n.settings.cropperHeight+2*(this.height-n.settings.cropperHeight)+"px",width:n.settings.cropperWidth+2*(this.width-n.settings.cropperWidth)+"px",top:-1*(this.height-n.settings.cropperHeight)+"px",left:-1*(this.width-n.settings.cropperWidth)+"px"}),i.draggable({axis:o,containment:t,stop:function(){n.settings.cropBoundaries=n.getCropBoundingBox(i,r)},cursor:"move"})}))):void require(["foundation/lib/jquery/jquery.draggable/1.11.4"],function(){this.createCropper(t)}.bind(this))}});return s}),define("shared/masthead/views/user-name-modal",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/views/modal","shared/masthead/templates","foundation/models/user-data","foundation/hosts","shared/account/views/user-profile-modal"],function(e,t,i,a,n,s,o,r){"use strict";var l=i.extend({events:{"click .premier-subscriber a":"handleUserSubscriptionClick","click li a":"handleUserOptionClick"},defaultSettings:{id:"user-name-modal",modalTitle:"",modalContent:"",binding:".user-name-button",tailDirection:"up-right",tailTopOffset:-8,tailLeftOffset:-1,width:"260px",toggleSpeed:1,openCallback:function(){this.$target.addClass("active"),this.listenToOnce(this.pageManager,"nyt:page-scroll",this.close)},closeCallback:function(){this.$target.removeClass("active")}},initialize:function(e){t.bindAll(this,"handleLogOut"),this.settings=t.extend({},this.defaultSettings,e),this.trackingBaseData={module:"ProfileDropdown",action:"click",region:"Masthead","WT.nav":"shell"}},handleUserReady:function(){var e,t=this.getSubscriptionLabel(s);this.settings.modalTitle=n.userNameModalTitle({userData:s,subscription:t}),this.settings.modalContent=n.userNameModalContent({userData:s,hosts:o}),new r,this.render(),e=this.$el.find(".user-subscription"),""===t.label&&e.remove(),""!==t.className&&e.addClass(t.className),""!==t.link&&e.find("a").attr("href",t.link),this.listenToOnce(s,"nyt:user-image-loaded",this.handleProfileImage),this.$el.on("click",".log-out-button",this.handleLogOut)},getSubscriptionLabel:function(e){var t={label:"",className:"",link:""};return e.isPremierSubscriber()?(t.label="Times Insider Subscriber",t.className="premier-subscriber",t.link="http://www.nytimes.com/section/insider"):e.isWebSubscriber()&&e.isMobileSubscriber()?t.label="All Digital Access Subscriber":e.isTabletSubscriber()&&e.isWebSubscriber()?t.label="Tablet and Web Subscriber":e.isSmartphoneSubscriber()&&e.isWebSubscriber()?t.label="Smartphone and Web Subscriber":e.isWebSubscriber()?t.label="Web Subscriber":e.isOpinionSubscriber()&&e.isCookingSubscriber()?t.label="NYT Opinion & Cooking Subscriber":e.isCookingSubscriber()?t.label="Cooking Subscriber":e.isOpinionSubscriber()?(t.label="NYT Opinion Subscriber",t.link="http://www.nytimes.com/content/help/mobile/nyt-opinion/nyt-opinion.html"):e.isCrosswordsSubscriber()&&(t.label="Crosswords Subscriber"),t},render:function(){var e=new a(this.settings);this.setElement(e.$modal),e.addToPage()},handleProfileImage:function(){var e=n.profileIcon({userData:s});this.$el.find(".modal-heading").prepend(e)},handleUserSubscriptionClick:function(t){var i=e(t.currentTarget),a=this.trackingAppendParams(i.attr("href"),{contentCollection:"TimesPremier-InsideStory"});i.attr("href",a)},handleUserOptionClick:function(t){var i=e(t.target),a=i.text(),n=i.attr("href"),s={action:"Click",region:"TopBar","WT.nav":"shell"};n&&(a&&(s.module=a.replace(/\s/g,"")),n=this.trackingAppendParams(n,s),i.attr("href",n))},handleLogOut:function(){var e="http:"+o.www+"/logout";e=this.trackingAppendParams(e,{module:"LogOut",action:"Click",region:"TopBar","WT.nav":"shell"}),this.trackingTrigger("tagx-auth-interaction",{module:"LogOut",state:s.isLoggedIn()?"logged in":"logged out",eventName:"logout click | LogOut"}),window.location=e}});return l}),define("shared/masthead/instances/masthead",["jquery/nyt","shared/masthead/views/masthead","shared/masthead/views/in-story-theme","shared/masthead/views/search","shared/masthead/views/user-settings-modal","shared/masthead/views/user-name-modal"],function(e,t,i,a,n,s){"use strict";new t,new a,new n({fixedOverride:!0,openCallback:function(){this.$target.addClass("active"),this.listenToOnce(this.pageManager,"nyt:masthead-storytheme",this.close)}}),new s({fixedOverride:!0,openCallback:function(){this.$target.addClass("active"),this.listenToOnce(this.pageManager,"nyt:masthead-storytheme",this.close)}}),e("#masthead .kicker").text().length>1&&new i}),define("shared/account/helpers/account-modal-mixin",["jquery/nyt","underscore/nyt","foundation/lib/polyfills/placeholder","shared/account/templates","foundation/models/token","foundation/hosts"],function(e,t,i,a,n,s){"use strict";var o={oauthProviders:["google","facebook"],handleFormSubmit:function(e){n.getToken()?(this.$el.find("#account-form-token").val(n.getToken()),this.$el.find("#account-form-expiration").val(n.getTokenExpiration()),this.$el.find("#login-remember").val(this.$el.find("#login-remember-checkbox").is(":checked")?1:0)):e.preventDefault()},handleFormButton:function(){n.getToken()?this.$el.find("form").submit():(this.subscribeOnce("nyt:myaccount-token",this.handleFormButton),n.loadData())},handleKeyUp:function(t){var i=e(t.target);i.parent().find(".clear-button").toggle(""!==i.val())},handleClearButton:function(t){var a=e(t.currentTarget),n=a.parent().find("input");a.toggle(!1),n.val(""),i()},executeOauthLogin:function(t){t.preventDefault(),this.oauthPopup(e(t.currentTarget).data("providerName"))},addEvent:function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)},getPageUrlParams:function(){var t,i=window.location,a={URI:i.protocol+"//"+i.hostname+"/"+i.pathname.replace(/^\//,"")};return i.search.length>1&&(t=i.search.substr(1),t=t.replace(/(\?|&)?gwh=([^&]+)/g,""),t=t.replace(/(\?|&)?gwt=([^&]+)/g,""),t=t.replace(/%/g,"Q"),a.OQ=t),e.param(a)},getSocialLinkUrl:function(e,t,i){return s.myaccount+"/oauth/"+t+"-link?type=login&URI="+e+(i?"&view=popup":"")+"&flow=HPLI"},oauthPopup:function(e){var i,a,n="oauthPopup",s=450,o=600;-1!==t.indexOf(this.oauthProviders,e)&&(a=["height="+o,"width="+s,"left="+(window.screen.availLeft+window.screen.width/2-s/2),"top="+Math.max(window.screen.height/2-o/2-20,0),"scrollbars=1"],i=window.open("about:blank",n,a.join(",")),i?(i=window.open(this.getSocialLinkUrl(document.URL,e,!0),n,a.join(",")),i.focus()):window.location.href=this.getSocialLinkUrl(document.URL,e))},renderOauthButtons:function(){return a.oauthButtons({facebookId:this.getFacebookButtonId(this.modalSettings.id),googleId:this.getGoogleButtonId(this.modalSettings.id),prefix:this.modalSettings.oauthButtonText})},addOauthEvents:function(e){this.$el.find("#"+this.getGoogleButtonId(e)+", #"+this.getFacebookButtonId(e)).on("click",t.bind(this.executeOauthLogin,this))},getFacebookButtonId:function(e){return"facebook-oauth-button-"+e},getGoogleButtonId:function(e){return"google-oauth-button-"+e}};return o}),define("shared/account/views/login-modal",["jquery/nyt","underscore/nyt","foundation/views/base-view","foundation/models/user-data","shared/modal/views/modal","shared/account/templates","foundation/hosts","shared/account/helpers/account-modal-mixin","foundation/lib/polyfills/placeholder"],function(e,t,i,a,n,s,o,r,l){"use strict";var d=i.extend(t.extend({},r,{state:a.isLoggedIn()?"logged in":"logged out",events:{"click .registration-modal-trigger":"handleRegisterClick","click #login-send-button":"handleFormButton","submit #login-form":"handleFormSubmit","click .clear-button":"handleClearButton","keyup .text":"handleKeyUp","click .oauth-button":"handleLoginModalClick","click .login-form":"handleLoginModalClick"},nytEvents:{"nyt:loginmodal-open":"handleOpen"},defaultSettings:{id:"login-modal",addlClasses:"account-modal",headerContent:s.accountModalHeader(),modalContent:"",modalFooter:s.loginModalFooter(),modalTitle:"Log in",moduleName:"LogIn",oauthButtonText:"Log in",binding:".login-modal-trigger",tailDirection:"fixed",hasCloseButton:!0,hasOverlay:!0,tailLeftOffset:-40,tailTopOffset:-40},initialize:function(e){var i=this;this.modalSettings=t.extend({},this.defaultSettings,e),this.registrationPlatform=!1,this.modalSettings.modalContent=s.logInModalContent({oauthButtons:this.renderOauthButtons(),loginUrl:o.myaccount+"/auth/login?"+this.getPageUrlParams(),forgotPasswordUrl:o.myaccount+"/seg/forgot-password?EXIT_URI="+encodeURIComponent(window.location.href)}),this.modalSettings.openCallback=function(){var e=i.modalTitle||this.$target.data("modal-title")||"Log in",t=i.moduleName||"LogIn";i.hasPlaceholderSupport&&this.$modal.find(".login-email").focus(),this.$modal.find("#login-modal-modal-heading").text(e),this.$modal.find(".modal-subheading").toggleClass("hidden","Log in"!==e),this.$modal.find(".field-container input").val(""),i.modalTitle=null,this.trackingTrigger("tagx-auth-interaction",{module:t,state:i.state,eventName:"modal popup | "+t})},this.subscribe("nyt:modal-show-login-modal",l)},handleDomReady:function(){this.render()},render:function(){this.logInModal=new n(this.modalSettings).addToPage(),this.setElement(this.logInModal.$modal),this.local(this,"nyt:modal-login-modal-rendered"),this.addOauthEvents(this.modalSettings.id)},handleOpen:function(e){e&&e.modalTitle&&(this.modalTitle=e.modalTitle),e&&e.moduleName&&(this.moduleName=e.moduleName),e&&e.registrationPlatform&&(this.registrationPlatform=e.registrationPlatform),this.logInModal&&this.logInModal.open()},handleUserReady:function(){a.isLoggedIn()&&(this.logInModal?(this.logInModal.removeFromPage(),this.remove()):this.subscribeOnce(this,"nyt:modal-login-modal-rendered",this.handleUserReady))},handleRegisterClick:function(e){var t={};e.stopPropagation(),this.registrationPlatform&&(t.platformTracking=this.registrationPlatform,this.registrationPlatform=!1),this.logInModal.close(),this.broadcast("nyt:registrationmodal-open",t),this.trackingTrigger("loginmodal-register-click",{module:"Registration",action:"Click","WT.z_ract":"Regnow"}),this.trackingTrigger("tagx-auth-interaction",{module:"Registration",state:this.state,eventName:"modal click | Registration"})},handleLoginModalClick:function(){this.trackingTrigger("tagx-auth-interaction",{module:"LogIn",state:this.state,eventName:"modal click | LogIn"})}}));return d}),define("shared/account/views/registration-modal",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/views/modal","shared/account/templates","foundation/hosts","shared/account/helpers/account-modal-mixin","foundation/lib/polyfills/placeholder"],function(e,t,i,a,n,s,o,r){"use strict";var l=i.extend(t.extend({},o,{events:{"click .login-modal-trigger":"handleLoginClick","click #register-send-button":"handleFormButton","submit #registration-form":"handleFormSubmit","click .clear-button":"handleClearButton","keyup .text":"handleKeyUp"},nytEvents:{"nyt:registrationmodal-open":"handleOpen"},defaultSettings:{id:"registration-modal",addlClasses:"account-modal",headerContent:n.accountModalHeader(),modalContent:"",modalFooter:n.registrationModalFooter(),modalTitle:"Sign up",oauthButtonText:"Sign up",binding:".registration-modal-trigger",tailDirection:"fixed",hasCloseButton:!0,hasOverlay:!0,tailLeftOffset:-40,tailTopOffset:-40},initialize:function(i){var a=this;this.modalSettings=t.extend({},this.defaultSettings,i),this.platformTracking=!1,this.modalSettings.modalContent=n.registrationModalContent({oauthButtons:this.renderOauthButtons(),regiUrl:s.myaccount+"/register?"+this.getPageUrlParams()}),this.modalSettings.openCallback=function(){a.hasPlaceholderSupport&&this.$modal.find(".register-email").focus(),this.$modal.find(".field-container input").val(""),e("#account-form-platform").remove(),a.platformTracking&&(e("#registration-form").append('<input id="account-form-platform" name="regi_info_platform" type="hidden" value="'+a.platformTracking+'">'),a.platformTracking=!1)},this.subscribe("nyt:modal-show-registration-modal",r)},handleDomReady:function(){this.render()},render:function(){this.registrationModal=new a(this.modalSettings).addToPage(),this.setElement(this.registrationModal.$modal),this.addOauthEvents(this.modalSettings.id)},handleLoginClick:function(){this.registrationModal.close()},handleOpen:function(e){e&&e.platformTracking&&(this.platformTracking=e.platformTracking),this.registrationModal&&this.registrationModal.open()}}));return l}),define("shared/account/instances/account",["shared/account/views/login-modal","shared/account/views/registration-modal","foundation/models/user-data"],function(e,t,i){"use strict";i.isLoggedIn()||(new e,new t)}),define("shared/navigation/templates",["underscore/nyt"],function(_){var templates={};return templates.mainPanel=function(obj){var __t,__p="";Array.prototype.join;with(obj||{}){__p+='<div class="sections">\n';var count=1;__p+="\n",_.each(level1,function(e){__p+='\n<div class="section '+(null==(__t=isVisible(e[0],count)===!1?"hidden":"")?"":__t)+'">\n<ul class="menu" role="menubar">\n',_.each(e,function(e){__p+="\n"+(null==(__t=liTemplate({model:e,isVisible:isVisible(e,count)}))?"":__t)+"\n",count+=iterateTemplateCount(e),__p+="\n"}),__p+="\n",count+=1,__p+="\n</ul>\n</div>\n"}),__p+="\n</div>"}return __p},templates.menuItem=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<li role="presentation" class="'+(null==(__t=isVisible===!1?"hidden":"menuitem-visible")?"":__t)+'">\n<a id="navId-'+(null==(__t=model.getTaxonomyId())?"":__t)+'"\nclass="'+(null==(__t=model.getEdition())?"":__t)+" "+(null==(__t=model.hasChildren()?"expandable":"")?"":__t)+'"\nrole="menuitem" '+(null==(__t=model.getPath()?' href="'+model.getPath()+'"':' tabindex="0"')?"":__t)+"\n"+(null==(__t=model.hasChildren()?' aria-haspopup="true" aria-expanded="false"':"")?"":__t)+">\n"+(null==(__t=model.get("name"))?"":__t)+"\n",model.hasChildren()&&(__p+='\n<div class="arrow arrow-right">\n<div class="arrow-conceal"></div>\n</div>\n',model.getLevel()>1&&(__p+='\n<div class="arrow arrow-left">\n<div class="arrow-conceal"></div>\n</div>\n'),__p+="\n"),__p+="\n</a>\n</li>";return __p},templates.mobileNav=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<section class="edition-navigation">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li class="'+(null==(__t=isGlobalEdition?"":"active")?"":__t)+'"><a href="http://mobile.nytimes.com/"><span>U.S. Edition</span></a></li>\n</ul>\n<ul class="menu">\n<li class="'+(null==(__t=isGlobalEdition?"active":"")?"":__t)+'"><a href="http://mobile.nytimes.com/international/"><span>International Edition</span></a></li>\n</ul>\n</section>\n<section class="primary-navigation">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/'+(null==(__t=isGlobalEdition?"international/":"")?"":__t)+'"><span>Home</span></a></li>\n<li><a href="http://mobile.nytimes.com/world/"><span>World</span></a></li>\n<li><a href="http://mobile.nytimes.com/national/"><span>U.S. '+(null==(__t=isGlobalEdition?"News":"")?"":__t)+'</span></a></li>\n<li><a href="http://mobile.nytimes.com/politics/"><span>'+(null==(__t=isGlobalEdition?"U.S.":"")?"":__t)+' Politics</span></a></li>\n<li><a href="http://mobile.nytimes.com/upshot/"><span>The Upshot</span></a></li>\n<li><a href="http://mobile.nytimes.com/nyregion/"><span>New York</span></a></li>\n<li><a href="http://mobile.nytimes.com/'+(null==(__t=isGlobalEdition?"international/":"")?"":__t)+'business/"><span>Business '+(null==(__t=isGlobalEdition?"":"Day")?"":__t)+'</span></a></li>\n<li><a href="http://mobile.nytimes.com/technology/"><span>Technology</span></a></li>\n<li><a href="http://mobile.nytimes.com/'+(null==(__t=isGlobalEdition?"international/":"")?"":__t)+'sports/"><span>Sports</span></a></li>\n</ul>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/'+(null==(__t=isGlobalEdition?"international/":"")?"":__t)+'opinion/"><span>Opinion</span></a></li>\n<li><a href="http://mobile.nytimes.com/science/"><span>Science</span></a></li>\n<li><a href="http://mobile.nytimes.com/health/"><span>Health</span></a></li>\n<li><a href="http://mobile.nytimes.com/'+(null==(__t=isGlobalEdition?"international/":"")?"":__t)+'arts/"><span>Arts</span></a></li>\n<li><a href="http://mobile.nytimes.com/'+(null==(__t=isGlobalEdition?"international/":"")?"":__t)+'style/"><span>Style</span></a></li>\n<li><a href="http://mobile.nytimes.com/photos/"><span>Photos</span></a></li>\n<li><a href="http://mobile.nytimes.com/video/"><span>Video</span></a></li>\n<li><a href="http://mobile.nytimes.com/most-emailed/"><span>Most Emailed</span></a></li>\n<li><a href="http://mobile.nytimes.com/times-insider/"><span>Times Insider</span></a></li>\n</ul>\n</section>\n<section class="secondary-navigation">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/automobiles/"><span>Automobiles</span></a></li>\n<li><a href="http://mobile.nytimes.com/blogs/"><span>Blogs</span></a></li>\n<li><a href="http://mobile.nytimes.com/books/"><span>Books</span></a></li>\n<li><a href="http://mobile.nytimes.com/'+(null==(__t=isGlobalEdition?"international/":"")?"":__t)+'dining/"><span>Food</span></a></li>\n<li><a href="http://mobile.nytimes.com/education/"><span>Education</span></a></li>\n<li><a href="http://mobile.nytimes.com/magazine/"><span>Magazine</span></a></li>\n<li><a href="http://mobile.nytimes.com/mens-style/"><span>Men\'s Style</span></a></li>\n<li><a href="http://mobile.nytimes.com/movies/"><span>Movies</span></a></li>\n<li><a href="http://mobile.nytimes.com/music/"><span>Music</span></a></li>\n<li><a href="http://mobile.nytimes.com/business/media/"><span>Media &amp; Advertising</span></a></li>\n<li><a href="http://mobile.nytimes.com/obituaries/"><span>Obituaries</span></a></li>\n</ul>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/publiceditor/"><span>Public Editor</span></a></li>\n',
isGlobalEdition||(__p+='\n<li><a href="http://mobile.nytimes.com/realestate/"><span>Real Estate</span></a></li>\n'),__p+='\n<li><a href="http://mobile.nytimes.com/opinion/sundayreview/"><span>Sunday Review</span></a></li>\n',isGlobalEdition&&(__p+='\n<li><a href="http://mobile.nytimes.com/opinion/international/greathomes/"><span>Great Homes and Destinations</span></a></li>\n'),__p+='\n<li><a href="http://mobile.nytimes.com/tmagazine/"><span>T Magazine</span></a></li>\n<li><a href="http://mobile.nytimes.com/television/"><span>Television</span></a></li>\n<li><a href="http://mobile.nytimes.com/theater/"><span>Theater</span></a></li>\n<li><a href="http://mobile.nytimes.com/timeswire/"><span>Times Wire</span></a></li>\n<li><a href="http://mobile.nytimes.com/travel/"><span>Travel</span></a></li>\n<li><a href="http://mobile.nytimes.com/weddings/"><span>Weddings</span></a></li>\n<li><a href="http://nytlive.nytimes.com/womenintheworld/"><span>Women In The World</span></a></li>\n<li><a href="http://mobile.nytimes.com/corrections/"><span>Corrections</span></a></li>\n</ul>\n</section>\n<section class="tertiary-navigation">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/recommendations/"><span>Recommendations</span></a></li>\n</ul>\n<ul class="menu">\n<li><a href="http://mobile.nytimes.com/saved/"><span>Saved</span></a></li>\n</ul>\n</section>\n<section class="settings '+(null==(__t=userData.isLoggedIn()?"":"hidden")?"":__t)+'">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><span class="label">Account:</span> '+(null==(__t=userData.getUserName())?"":__t)+'</li>\n</ul>\n</section>\n<section class="logout '+(null==(__t=userData.isLoggedIn()?"":"hidden")?"":__t)+'">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><a href="https://myaccount.nytimes.com/mobile/logout/smart/index.html?EXIT_URI='+(null==(__t=encodeURIComponent(window.location))?"":__t)+'"><span>Log out</span></a></li>\n</ul>\n</section>\n<section class="account '+(null==(__t=userData.isLoggedIn()?"hidden":"")?"":__t)+'">\n<h2 class="section-heading visually-hidden">Navigation Section</h2>\n<ul class="menu">\n<li><a href="http://www.nytimes.com/mowweb/ftnotlog"><span>Subscribe</span></a></li>\n</ul>\n<ul class="menu">\n<li><a href="https://myaccount.nytimes.com/mobile/login/smart/index.html?EXIT_URI='+(null==(__t=encodeURIComponent(window.location))?"":__t)+'"><span>Log In</span></a></li>\n</ul>\n</section>';return __p},templates.navigationModalContent=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="secondary-container">\n'+(null==(__t=secondary)?"":__t)+'\n</div>\n<div class="tertiary-container">\n'+(null==(__t=tertiary)?"":__t)+"\n</div>";return __p},templates.secondaryPanel=function(obj){var __t,__p="";Array.prototype.join;with(obj||{}){__p+='<div class="secondary-container">\n<div class="header">\n<h5 class="section-heading"><a href="" role="menuitem"></a></h5>\n</div>\n';var count=1;__p+="",_.each(level2,function(e){__p+='\n<div class="section '+(null==(__t="432A1823-3F24-43C0-8004-79088F94E754"===e[0].getParentId()?"video":"")?"":__t)+'" data-parent="navId-'+(null==(__t=e[0].getParentId())?"":__t)+'">\n<ul class="secondary" role="menu">\n',_.each(e,function(e){__p+="\n"+(null==(__t=liTemplate({model:e,isVisible:!0}))?"":__t)+"\n"}),__p+="\n</ul>\n</div><!-- close secondary "+(null==(__t=e[0].getParentId())?"":__t)+" sections -->\n"}),__p+="",_.each(level1,function(e){__p+='\n<div class="section section-more '+(null==(__t=isVisible(e[0],count,!0)===!1?"hidden":"")?"":__t)+'"  data-parent="navId-more-section">\n<ul class="secondary" role="menu">\n',_.each(e,function(e){__p+="\n"+(null==(__t=liTemplate({model:e,isVisible:isVisible(e,count,!0)}))?"":__t)+"\n",count+=iterateTemplateCount(e),__p+="\n"}),__p+="\n",count+=1,__p+="\n</ul>\n</div>\n"}),__p+="</div><!-- close secondary modal -->"}return __p},templates.tertiaryPanel=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="header">\n<h5 class="section-heading"><a href="" role="menuitem"></a></h5>\n</div>\n',_.each(level3,function(e,t){__p+='\n<ul class="tertiary" data-parent="navId-'+(null==(__t=e[0].getParentId())?"":__t)+'" role="menu">\n',_.each(e,function(e,t){__p+="\n"+(null==(__t=liTemplate({model:e,isVisible:!0}))?"":__t)+"\n"}),__p+="\n</ul>\n"}),__p+="";return __p},templates}),define("shared/data/models/section",["backbone/nyt"],function(e){"use strict";var t=e.Model.extend({defaults:{name:"",edition:"",className:"",path:"",show_in_nav:!0,hasSubsections:!1,level:1,taxonomyId:""},getTaxonomyId:function(){return this.get("taxonomyId")},getParentId:function(){return this.get("parent")},getEdition:function(){var e=this.get("edition");return"global"===e?"international":e},hasChildren:function(){return this.get("hasSubsections")},getPath:function(){return this.get("path")},getLevel:function(){return this.get("level")}});return t}),define("shared/data/collections/taxonomy",["backbone/nyt","underscore/nyt","foundation/collections/base-collection","shared/data/models/section","foundation/hosts","foundation/models/user-data"],function(e,t,i,a,n){"use strict";var s=i.extend({url:n.staticHost+"/services/json/taxonomy/v2/flat.jsonp",model:a,sectionMarkers:["C5BFA7D5-359C-427B-90E6-6B7245A6CDD8","5C13EEDD-D905-4D8C-A284-6859EA434563","8FB1308A-FFE4-4BED-ADF6-659A680D0884","6101A43A-8BDE-45FF-AAD5-EF7396F83AC9","FED853D9-D192-46F6-8D18-447803EB4A7B"],initialize:function(){this.editionString="us"===this.pageManager.getEdition()?"domestic":"global",this.level1=[],this.level2=[],this.level3=[],this.fetch()},sync:function(t,i,a){return a.dataType="jsonp",a.jsonpCallback="jsonTaxonomyCallback",a.cache=!0,e.sync(t,i,a)},parse:function(i){var n,s,o,r=0,l=new e.Collection,d=t.map(i.elements,function(e){return e.taxonomyId=e.id,e.id=r++,e});for(l.model=a,l.reset(d),n=l.where({parent:null}),s=0,r=0,o=n.length;o>r;r+=1)t.indexOf(this.sectionMarkers,n[r].get("taxonomyId"))>=0&&(this.levelData(l,n.slice(s,r),0),s=r);return this.levelData(l,n.slice(s,n.length),0),this.level1.push([new a({name:"More",taxonomyId:"more-section",hasSubsections:!0})]),l.toJSON()},levelData:function(e,i,a){var n,s,o,r,l,d,h;if(t.isArray(i))for(this["level"+(a+1)].push(i),n=0,s=i.length;s>n;n+=1)this.levelData(e,i[n],a+1);else 3>a&&(h=e.where({taxonomyId:i.get("taxonomyId")}).length>1,o=e.where({parent:i.get("taxonomyId"),show_in_nav:!0}),h&&(o=t.uniq(o,function(e){return e.get("taxonomyId")}))),r=o&&o.length>0,i.set("className",i.get("name").replace(/[^a-zA-Z0-9]/g,"").toLowerCase()),i.set("hasSubsections",r),i.set("level",a),l=i.get("alternate_editions"),l&&l[this.editionString]&&(d=e.findWhere({taxonomyId:l[this.editionString]}),i.set("editionName",d.get("name")),i.set("editionPath",d.get("path"))),r&&this.levelData(e,o,a)},getPrimarySections:function(){return this.level1},getSecondarySections:function(){return this.level2},getTertiarySections:function(){return this.level3},getSectionByKeyword:function(e){return this.find(function(t){var i=t.get("path")||"";return i.indexOf("/"+e+"/index.html")>0})}});return s}),define("shared/data/instances/taxonomy",["shared/data/collections/taxonomy"],function(e){"use strict";return new e}),define("shared/navigation/views/navigation",["module","jquery/nyt","underscore/nyt","foundation/views/base-view","foundation/views/page-manager","foundation/hosts","foundation/models/user-data","shared/modal/views/modal","shared/navigation/templates","shared/data/instances/taxonomy"],function(e,t,i,a,n,s,o,r,l,d){"use strict";var h=a.registerView("navigation").extend({module:e,el:"#navigation",navTemplate:l.navigation,modalTemplate:l.navigationModalContent,events:{mouseleave:"delayedClose",mouseenter:"cancelDelayedClose","mouseenter li a":"tryPrimaryHover","mouseleave li a.expandable":"delayedModalClose","click li a":"activatePrimaryItem","click .menu a[href]":"handlePrimaryNavigationClick"},nytEvents:{"nyt:masthead-section-click":"toggle","nyt:navigation-toggle-ready":"toggle","nyt:navigation-edge-click":"open","nyt:navigation-edge-mouse-enter":"delayedOpen","nyt:navigation-edge-mouse-leave":"cancelDelayedOpen","nyt:messaging-critical-alerts-move-furniture":"moveNav","nyt:messaging-suggestions-move-furniture":"moveNav","nyt:a11y-enabled":"enableA11Nav","nyt:a11y-disabled":"disableA11yNav"},defaultSettings:{panelwidth:210,navTimeout:500,navAnimation:150,hoverTimeout:500,intentRangeLower:10,intentRangeUpper:170,maxMouseLocs:2,a11yEnabled:!1},modalSettings:{id:"navigation-modal",modalTitle:"",modalContent:"",tailDirection:"left-top",closeOnClick:!1,fixedOverride:!0,autoPosition:!0,positionTailSide:!0,toggleSpeed:1},mouseLocs:[],navIds:{REAL_ESTATE:"navId-92720057-BCB6-4BDB-9351-12F29393259F",OPINION_DOMESTIC:"navId-09736473-CB3F-4B2F-9772-3AF128ABE12D",OPINION_INTERNATIONAL:"navId-AD8090D7-4137-4D71-84C8-70DA3BD89778",VIDEO:"navId-432A1823-3F24-43C0-8004-79088F94E754",CONFERENCES:"navId-0442C365-4B63-4B63-B9DE-3C28319CB622",MORE:"navId-more-section"},navLevels:{PRIMARY:1,SECONDARY:2,TERTIARY:3},initialize:function(e){i.bindAll(this,"tryPrimaryHover","trySecondaryHover","open","close","render","saveMousePosition","delayedOpen","delayedClose","cancelDelayedOpen","cancelDelayedClose","delayedModalOpen","delayedModalClose","cancelDelayedModalOpen","cancelDelayedModalClose","delayedPrimaryHover","cancelDelayedPrimaryHover","delayedSecondaryHover","cancelDelayedSecondaryHover","handleClickClose","handleTapClose","detectFalsePositive","isNavItemVisible","iterateTemplateCount"),this.settings=i.extend({},this.defaultSettings,e),this.singlePanelWidth=this.settings.panelwidth+"px",this.singlePanelPartlyShut=this.settings.panelwidth-20+"px",this.isNavAnimating=!1,this.timer={},d.length>0?this.render():this.subscribeOnce(d,"sync",this.render),this.$document.on("click","#navigation-modal a[href]",i.bind(this.handleModalClick,this)),this.trackingBaseData={module:"SectionsNav",action:"click",version:"BrowseTree",region:"TopBar"}},handleUserReady:function(){this.updateCrosswordSubscriptionLink()},updateCrosswordSubscriptionLink:function(){var e=o.isTabletSubscriber(),i=o.isSmartphoneSubscriber(),a=o.isHomeDeliverySubscriber(),n=o.isPremierSubscriber(),r=o.isOpinionSubscriber(),l=o.isCrosswordsSubscriber(),d=s.www+"/subscriptions/games/lp8J6KQ.html?campaignId=49W96",h=s.www+"/subscriptions/games/lp897H9.html?campaignId=49W8Y";(e||i||a||n||r)&&!l?t("#nyt-crossword").attr("href",d):l||t("#nyt-crossword").attr("href",h)},handlePrimaryNavigationClick:function(e){var i=t(e.currentTarget),a=this.trackingAppendParams(i.attr("href"),{contentCollection:t.trim(i.text())});i.attr("href",a)},handleModalClick:function(e){var i=t(e.currentTarget),a=t.trim(t("#navigation-modal").find(".secondary-container .header").text()),n=this.trackingAppendParams(i.attr("href"),{contentCollection:a+"/"+t.trim(i.text()),contentPlacement:i.closest("ul").hasClass("secondary")?2:3});i.attr("href",n)},moveNav:function(e){e(this.$el)},render:function(){var e,t,a,n=23,s=33,o=this,h=this.$body.find(".navigation-modal");this.navItemsInView=n,this.navItemsInView=Math.floor((this.pageManager.getViewport().height-41)/26),this.pageManager.isMobile()?this.navItemsInView=n:this.navItemsInView>s?this.navItemsInView=s:this.navItemsInView<n&&(this.navItemsInView=n),this.$el.append(l.mainPanel({level1:d.getPrimarySections(),liTemplate:l.menuItem,isVisible:this.isNavItemVisible,iterateTemplateCount:this.iterateTemplateCount})),e=l.secondaryPanel({level1:i.initial(d.getPrimarySections()),level2:d.getSecondarySections(),liTemplate:l.menuItem,isVisible:this.isNavItemVisible,iterateTemplateCount:this.iterateTemplateCount}),t=l.tertiaryPanel({level3:d.getTertiarySections(),liTemplate:l.menuItem}),h.eq(0).remove(),this.modalSettings.modalContent=l.navigationModalContent({secondary:e,tertiary:t}),this.navigationModal=new r(this.modalSettings),this.navigationModal.addToPage(),this.navigationModal.$modal.on("mouseover",".secondary li a",o.trySecondaryHover).on("click",".secondary li a.expandable",o.activateSecondaryItem).on("mouseenter",".tertiary-container",o.cancelDelayedSecondaryHover).on("mouseenter",function(){o.cancelDelayedClose(),o.cancelDelayedModalClose(),o.cancelDelayedPrimaryHover()}).on("mouseleave",function(){o.delayedClose(),o.delayedModalClose()}),this.navigationModal.$modal.find(".secondary-container .hidden .menuitem-visible").eq(0).closest(".section").removeClass("hidden"),a=this.navigationModal.$modal.find(".section-more"),this.moreInModalHeight=25*a.find(".menuitem-visible").length+30*a.not(".hidden").length+45},isNavItemVisible:function(e,t,i){return i?t>this.navItemsInView&&"more-section"!==e.getTaxonomyId():t<=this.navItemsInView||"more-section"===e.getTaxonomyId()},iterateTemplateCount:function(e){var t="global"===this.pageManager.getEdition()?"international":"domestic";return e.getEdition()&&t!==e.getEdition()?0:1},toggle:function(){this.$el.hasClass("active")?this.close():this.open()},open:function(){var e=this,t={width:e.singlePanelPartlyShut,display:"block",opacity:"0"},i={width:e.singlePanelWidth,opacity:"1"};this.isNavAnimating||this.$el.hasClass("active")!==!1||(this.$el.css(t),this.$el.toggleClass("active"),this.$html.toggleClass("navigation-active"),this.isNavAnimating=!0,this.$el.animate(i,this.settings.navAnimation,function(){e.isNavAnimating=!1,e.$body.on("click",e.handleTapClose)}),this.pageManager.isMobile()&&this.$body.css("cursor","pointer"),this.settings.a11yEnabled&&this.toggleFocusEvents(!0),this.broadcast("nyt:navigation-opened",this),this.$document.on("mousemove",this.saveMousePosition))},close:function(){var e,t,i;this.isNavAnimating||this.$el.hasClass("active")!==!0||(e=this,t=this.$el.css("marginTop"),i={width:this.singlePanelPartlyShut,opacity:"0"},this.navigationModal.close(),this.resetNav(this.navLevels.SECONDARY),this.isNavAnimating=!0,this.$el.animate(i,this.settings.navAnimation,function(){e.$el.toggleClass("active"),e.$html.toggleClass("navigation-active"),e.$body.off("click",e.handleClickClose),e.$body.off("click",e.handleTapClose),e.$el.removeAttr("style"),e.$el.css("marginTop",t),e.$el.find("a").removeClass("active"),e.isNavAnimating=!1}),this.pageManager.isMobile()&&this.$body.css("cursor",""),this.settings.a11yEnabled&&this.toggleFocusEvents(!1),this.broadcast("nyt:navigation-closed",this),this.$document.off("mousemove",this.saveMousePosition))},resetNav:function(e){var t=this.navigationModal.$modal;e===this.navLevels.SECONDARY&&t.find(".section").removeClass("active"),t.find(".secondary a").removeClass("active"),t.find(".tertiary").removeClass("active"),t.find(".modal-content").removeClass("expanded"),t.find(".section-heading a").removeClass("active")},activatePrimaryItem:function(e){var i,a,n,s,o,r,l,d=t(e.target).closest("a"),h=d.attr("id");e.stopPropagation(),d.hasClass("active")||this.isNavAnimating!==!1||(d.hasClass("expandable")?(i=this.navigationModal,a=i.$modal.find('[data-parent="'+h+'"]').find("li").length,n=55,s=29*a,o=s+n,l=i.$modal.find(".secondary-container"),h===this.navIds.MORE?o=this.moreInModalHeight||553:h===this.navIds.OPINION_DOMESTIC||h===this.navIds.OPINION_INTERNATIONAL?o=357:h===this.navIds.VIDEO?(o=310,l.css("width","380px")):h===this.navIds.CONFERENCES&&l.css("width","220px"),this.cancelDelayedModalClose(),this.resetNav(this.navLevels.SECONDARY),i.$modal.height(o),e.currentTarget=e.target,i.open(e),this.moveModalArrow(),this.$el.find("a").removeClass("active").attr("aria-expanded","false"),d.addClass("active").attr("aria-expanded","true"),i.$modal.find(".secondary").removeClass("active"),r=i.$modal.find(".secondary-container .section-heading"),this.setHeadingText(d,r),i.$modal.find('[data-parent="'+h+'"]').addClass("active"),h!==this.navIds.VIDEO&&h!==this.navIds.CONFERENCES&&l.css("width","190px"),this.broadcast("nyt:navigation-level-one-open",i.$modal)):this.modalClose())},setHeadingText:function(e,t){e.attr("href")?t.html('<a href="'+e.attr("href")+'" tabinxdex="0" role="menuitem" class="active">'+e.text()+"</a>"):t.html(e.text())},moveModalArrow:function(){var e,i,a,n=this.navigationModal.$modal,s=12,o=18,r=39,l=this.settings.panelwidth-10;t("html").hasClass("viewport-large-70")&&(l+=t("#navigation-edge").width()),n.css("left",l+"px"),e=n.find(".modal-pointer"),e.hasClass("modal-pointer-left")?(i=Math.floor(n.outerHeight()/2)-o,e.css("top",i+"px")):e.hasClass("modal-pointer-left-top")?e.css("top",s,"px"):e.hasClass("modal-pointer-left-bottom")&&(a=n.outerHeight()-r,e.css("top",a+"px"))},activateSecondaryItem:function(e){var i,a,n=t(e.target).closest("a");n.hasClass("active")||this.isNavAnimating!==!1||(e.preventDefault(),i=this.navigationModal.$modal,n.hasClass("expandable")?(this.resetNav(this.navLevels.TERTIARY),i.find(".modal-content").addClass("expanded"),a=i.find(".tertiary-container .section-heading"),this.setHeadingText(n,a),i.find('[data-parent="'+n.attr("id")+'"]').eq(0).addClass("active"),n.addClass("active").attr("aria-expanded","true"),this.broadcast("nyt:navigation-level-two-open",i.find(".tertiary-container"))):(this.resetNav(this.navLevels.TERTIARY),n.addClass("active")))},tryPrimaryHover:function(e){var i,a=t(e.target).closest("a"),n=a.hasClass("expandable");this.cancelDelayedClose(),n&&this.cancelDelayedModalClose(),this.cancelDelayedPrimaryHover(),this.$el.find("li a.active").length>0?(i=this.getAngle(this.mouseLocs[0],this.mouseLocs[1]),i>this.defaultSettings.intentRangeLower&&i<this.defaultSettings.intentRangeUpper?this.delayedPrimaryHover(e):this.activatePrimaryItem(e)):this.activatePrimaryItem(e)},trySecondaryHover:function(e){var t;this.cancelDelayedClose(),this.cancelDelayedModalClose(),this.cancelDelayedSecondaryHover(),this.navigationModal.$modal.find(".modal-content").hasClass("expanded")?(t=this.getAngle(this.mouseLocs[0],this.mouseLocs[1]),t>this.defaultSettings.intentRangeLower&&t<this.defaultSettings.intentRangeUpper?this.delayedSecondaryHover(e):this.activateSecondaryItem(e)):this.activateSecondaryItem(e)},getAngle:function(e,t){var i,a,n,s,o,r,l;return e&&t?(i=e.x,a=e.y,n=t.x,s=t.y,o=n-i,r=s-a,l=Math.round(180*Math.atan2(o,r)/Math.PI*10)/10):null},delayedOpen:function(){this.timer.navOpen=window.setTimeout(this.open,this.defaultSettings.navTimeout)},delayedClose:function(){this.timer.navClose=window.setTimeout(this.close,this.defaultSettings.navTimeout)},cancelDelayedOpen:function(){window.clearTimeout(this.timer.navOpen)},cancelDelayedClose:function(){window.clearTimeout(this.timer.navClose)},delayedModalOpen:function(){this.timer.modalOpen=window.setTimeout(this.navigationModal.open,this.defaultSettings.navTimeout)},delayedModalClose:function(){var e=this;this.cancelDelayedPrimaryHover(),this.cancelDelayedSecondaryHover(),this.timer.modalClose=window.setTimeout(function(){e.modalClose()},this.defaultSettings.navTimeout)},modalClose:function(){this.$el.find("a").removeClass("active"),this.navigationModal.close(),this.broadcast("nyt:navigation-level-one-closed")},cancelDelayedModalOpen:function(){window.clearTimeout(this.timer.modalOpen)},cancelDelayedModalClose:function(){window.clearTimeout(this.timer.modalClose)},delayedPrimaryHover:function(e){var t=this;t.timer.primaryHoverIntent=window.setTimeout(function(){t.activatePrimaryItem(e)},this.defaultSettings.hoverTimeout)},cancelDelayedPrimaryHover:function(){window.clearTimeout(this.timer.primaryHoverIntent)},delayedSecondaryHover:function(e){var t=this;t.timer.secondaryHoverIntent=window.setTimeout(function(){t.activateSecondaryItem(e)},this.defaultSettings.hoverTimeout)},cancelDelayedSecondaryHover:function(){window.clearTimeout(this.timer.secondaryHoverIntent)},handleClickClose:function(e){0===t(e.target).closest("#navigation, #navigation-modal").length&&this.close()},handleTapClose:function(e){0===t(e.target).closest("#navigation, #navigation-modal").length&&this.close()},saveMousePosition:function(e){this.mouseLocs.length>1?(this.mouseLocs[1].x!==e.pageX||this.mouseLocs[1].y!==e.pageY)&&(this.mouseLocs.push({x:e.pageX,y:e.pageY}),this.mouseLocs.length>this.defaultSettings.maxMouseLocs&&this.mouseLocs.shift()):this.mouseLocs.push({x:e.pageX,y:e.pageY})},toggleFocusEvents:function(e){var t=e?"subscribe":"stopSubscribing";this[t]("nyt:page-key-tab nyt:page-key-up-a11y nyt:page-key-down-a11y",this.handleFocusKey),this[t]("nyt:page-key-esc-a11y nyt:page-key-left-a11y",this.handleCollapseKey),this[t]("nyt:page-key-enter nyt:page-key-right-a11y",this.handleExpandKey),this[t]("nyt:navigation-level-one-open nyt:navigation-level-two-open",this.addFocusableElements),e?(this.focusableElements=[],this.addFocusableElements(),this.$document.on("mousemove",this.detectFalsePositive)):delete this.focusableElements},addFocusableElements:function(e){var t,a;this.settings.a11yEnabled&&(e&&e.length>0?a=".active a[role=menuitem]:visible, .section-heading a.active[role=menuitem]:visible":(e=this.$el,a="a[role=menuitem]:visible, .section-heading a.active[role=menuitem]:visible"),t=e.find(a).toArray(),this.focusableElements.push({first:t[0],all:t,last:i.last(t)}),t[0].focus())},handleFocusKey:function(e){var t=i.last(this.focusableElements),a=this.getKeyDirection(e),n=document.activeElement;if(n===t.last&&"forward"===a)t.first.focus();else if(n===t.first&&"backward"===a)t.last.focus();else if("forward"===a)t.all[i.indexOf(t.all,n)+1].focus();else{if("backward"!==a)return;t.all[i.indexOf(t.all,n)-1].focus()}e.preventDefault()},handleCollapseKey:function(){var e;this.focusableElements.pop(),e=i.last(this.focusableElements),this.focusableElements.length>1?(this.resetNav(this.navLevels.TERTIARY),e.active.focus()):this.focusableElements.length>0?(this.modalClose(),e.active.focus()):this.close()},handleExpandKey:function(e){var a=t(document.activeElement),n=i.last(this.focusableElements);n.active=a,a.hasClass("expandable")&&(e.preventDefault(),a.closest(".secondary").length>0?this.activateSecondaryItem(e):this.activatePrimaryItem(e))},detectFalsePositive:i.throttle(function(e){t(e.target).is('a[role="menuitem"], li[role="presentation"')&&this.disableA11yNav()},1e3),getKeyDirection:function(e){var t="",i=this.pageManager.KEYS,a=e&&e.keyCode?e.keyCode:null;switch(a){case i.UP:case i.LEFT:t="backward";break;case i.DOWN:case i.RIGHT:case i.TAB:t="forward"}return t},enableA11Nav:function(){this.settings.a11yEnabled=!0},disableA11yNav:function(){this.settings.a11yEnabled=!1,this.toggleFocusEvents(!1),this.$document.off("mousemove",this.detectFalsePositive)}});return h}),define("shared/navigation/views/navigation-edge-adjust",["jquery/nyt","underscore/nyt","foundation/views/base-view"],function(e,t,i){"use strict";var a=i.registerView("navigation").extend({el:"#navigation-edge",events:{mouseenter:"handleMouseOver",mouseleave:"handleMouseOut",click:"handleClick"},nytEvents:{"nyt:page-breakpoint":"handleBreakPoint"},initialize:function(){this.pageManager.isDomReady()?this.render():this.subscribe("nyt:page-ready",this.render)},render:function(){this.$shell=e("#shell"),this.pageManager.getCurrentBreakpoint()>=10070&&(this.setNavWidth(),this.subscribe("nyt:page-resize",this.setNavWidth))},setNavWidth:function(){var e=this.$shell.offset();this.$shell.offset()&&(this.broadcast("nyt:navigation-edge-size-change",e.left),this.$el.css("width",e.left))},handleBreakPoint:function(e){e>=10070?this.subscribe("nyt:page-resize",this.setNavWidth):(this.stopSubscribing("nyt:page-resize",this.setNavWidth),this.$el.css("width",""))},handleMouseOver:function(e){(0!==e.clientX||0!==e.clientY)&&this.broadcast("nyt:navigation-edge-mouse-enter",e)},handleMouseOut:function(e){this.broadcast("nyt:navigation-edge-mouse-leave",e)},handleClick:function(){this.broadcast("nyt:navigation-edge-click")}});return a}),define("shared/navigation/views/mobile-navigation",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/navigation/views/navigation","shared/navigation/views/navigation-edge-adjust","shared/navigation/templates","foundation/models/user-data"],function(e,t,i,a,n,s,o){"use strict";var r=i.registerView("mobile-navigation").extend({el:"#mobile-navigation",hiddenEl:"#main, #ribbon, #site-index",nytEvents:{"nyt:masthead-section-click":"handleSectionClick","nyt:page-breakpoint":"handleBreakPoint"},handleUserReady:function(){this.$masthead=e("#masthead").find(".sections-button"),this.render()},render:function(){this.$el.append(s.mobileNav({userData:o,isGlobalEdition:this.pageManager.isInternationalEdition()}))},open:function(){this.$el.removeClass("hidden"),this.$masthead.addClass("mobile-navigation-active"),this.$el.focus(),e(this.hiddenEl).addClass("hidden"),window.scrollTo(0,0)},close:function(){this.$el.addClass("hidden"),this.$masthead.removeClass("mobile-navigation-active"),e(this.hiddenEl).removeClass("hidden")},handleSectionClick:function(){this[this.$el.is(":visible")?"close":"open"]()},handleBreakPoint:function(e){e>=120&&(new a,new n,this.close(),this.remove())}});return r}),define("shared/navigation/views/site-index-responsive",["jquery/nyt","underscore/nyt","foundation/views/base-view"],function(e,t,i){"use strict";var a=i.registerView("navigation").extend({events:{"click a":"handleSiteIndexClick","click .menu-heading":"handleClick","click .menu-label":"handleClick","keyup .menu-heading":"handleKeyboard"},nytEvents:{"nyt:page-breakpoint":"handleBreakPoint"},initialize:function(){var e=this.$el.find(".column");this.$columnHeader=e.find("h3"),this.$columnContents=e.find("ul")},handleDomReady:function(){this.render()},render:function(){this.subscribe("nyt:page-resize",this.setNavWidth),this.handleBreakPoint()},handleBreakPoint:function(){var t,i,a,n;this.pageManager.getCurrentBreakpoint()>=1e3?(this.isSmallSiteIndex=!1,t="removeClass",i="removeAttr",this.$columnContents[t]("expanded")[t]("collapsed")[i]("aria-expanded","true")[i]("aria-expanded","false")):(this.isSmallSiteIndex=!0,t="addClass",i="attr",this.$columnContents[t]("collapsed")[i]("aria-expanded","true")[i]("aria-expanded","false")),this.$columnHeader[t]("toggle")[i]("role","button")[i]("tabindex","0")[i]("aria-pressed","true")[i]("aria-pressed","false"),e.each(this.$columnHeader,function(t,s){n=e(s),a=n.text(),a=a.substr(0,a.indexOf(" ")).toLowerCase(),n[i]("id",a+"-menu-heading")[i]("aria-controls",a+"-menu"),n.siblings("ul")[i]("id",a+"-menu")[i]("aria-labelled-by",a+"-menu-heading")})},handleKeyboard:function(e){(13===e.keyCode||32===e.keyCode)&&this.handleClick(e)},handleClick:function(t){var i,a,n;this.isSmallSiteIndex&&(a=e(t.target),i=a.nextAll("ul"),n=i.find("a"),i.toggleClass("collapsed"),i.toggleClass("expanded"),"false"===a.attr("aria-pressed")?(a.attr("aria-pressed","true"),i.attr("aria-expanded","true"),n.removeAttr("tabindex","-1")):(a.attr("aria-pressed","false"),i.attr("aria-expanded","false"),n.attr("tabindex","-1")))},handleSiteIndexClick:function(t){var i=e(t.currentTarget),a=this.trackingAppendParams(i.attr("href"),{module:"SiteIndex",region:"Footer"});i.attr("href",a)}});return a}),define("shared/navigation/instances/navigation",["jquery/nyt","foundation/views/page-manager","shared/navigation/views/navigation","shared/navigation/views/mobile-navigation","shared/navigation/views/navigation-edge-adjust","shared/navigation/views/site-index-responsive"],function(e,t,i,a,n,s){"use strict";t.getCurrentBreakpoint()>=120?(new i,new n):new a,new s({el:e("#site-index")})}),define("shared/sharetools/models/share-data",["foundation/models/base-model"],function(e){"use strict";var t=e.extend({dataAttributes:{URL:"data-url",TITLE:"data-title",MEDIA:"data-media",DESCRIPTION:"data-description",PUBLICATION_DATE:"data-publish-date",CONTENT_TYPE:"data-content-type",AUTHOR:"data-author",VIA:"data-via"},initialize:function(e){this.$container=e},getUrl:function(){var e=this.$container.attr(this.dataAttributes.URL);return e?e:this.pageManager.getCanonical()},setUrl:function(e){this.$container.attr(this.dataAttributes.URL,e)},getTitle:function(){var e=this.$container.attr(this.dataAttributes.TITLE);return e?e:this.pageManager.getMeta("og:title")},setTitle:function(e){this.$container.attr(this.dataAttributes.TITLE,e)},getAuthor:function(){var e=this.$container.attr(this.dataAttributes.AUTHOR);return e?e:this.pageManager.getMeta("byl")},setAuthor:function(e){this.$container.attr(this.dataAttributes.AUTHOR,e)},getMedia:function(){var e=this.$container.attr(this.dataAttributes.MEDIA);return e?e:this.pageManager.getMeta("og:image")},setMedia:function(e){this.$container.attr(this.dataAttributes.MEDIA,e)},getDescription:function(){var e=this.$container.attr(this.dataAttributes.DESCRIPTION);return e?e:this.pageManager.getMeta("description")},setDescription:function(e){this.$container.attr(this.dataAttributes.DESCRIPTION,e)},getPublicationDate:function(){var e=this.$container.attr(this.dataAttributes.PUBLICATION_DATE);return e?e:this.pageManager.getMeta("DISPLAYDATE")},setPublicationDate:function(e){this.$container.attr(this.dataAttributes.PUBLICATION_DATE,e)},getVia:function(){var e=this.$container.attr(this.dataAttributes.VIA),t=this.pageManager.getMeta("twitter:site");return e?e:"upshot"===this.pageManager.getMeta("CG")?"UpshotNYT":t&&"@nytimes"!==t?t.replace("@",""):""},setVia:function(e){this.$container.attr(this.dataAttributes.VIA,e)},getContentType:function(){var e=this.$container.attr(this.dataAttributes.CONTENT_TYPE);return e?e:"Content"},setContentType:function(e){this.$container.attr(this.dataAttributes.CONTENT_TYPE,e)}});return t}),define("shared/ad/models/ad",["backbone/nyt"],function(e){"use strict";var t=e.Model.extend({});return t}),define("shared/ad/collections/ads",["backbone/nyt","underscore/nyt","foundation/collections/base-collection","foundation/hosts","shared/ad/models/ad"],function(e,t,i,a,n){"use strict";var s=i.extend({deliveryProofParams:["adxforce","debug"],adForceLookup:{leaderboard:"728x90testnyt5",billboard:"970x90horiztest",pushdown:"testnyt5pushdown",halfpage:"mediamindhalfexptest",xxl:"nyt5xxltestpickletag",bigad:"middlerighttest"},initialize:function(e,i){return i?(this.options=i,t.isUndefined(this.pageManager.getMeta("adxPage"))?this.host=this.pageManager.getUrlParam("adx_campaign")||i.adx_campaign||"www.nytimes.com":(this.host="",this.options.page=this.pageManager.getMeta("adxPage")),this.interstitial=i.interstitial?1:0,void this.setPageParameter()):!1},setPageParameter:function(){var e;this.options.page||(e=location.pathname,e=e.replace(/\d{4}/,"yr").replace(/\d{2}/,"mo").replace(/\d{2}/,"day"),this.options.page=this.host+e)},model:n,url:a.ADXHost+"/adx/bin/adxrun.html",sync:function(i,a,n){var s=this,o=["nyt5"];return n.dataType="jsonp",n.jsonp="jsonp",n.data={page:s.options.page,positions:s.options.positions.join(","),autoconfirm:s.options.autoconfirm||0,v:3,cpp:1,attributes:"nyt5",interstitials:this.interstitial,secureClientside:1},this.options.cpp===!1&&(delete n.data.interstitials,delete n.data.cpp),n.data=s.assignDeliveryProofParams(n.data),"undefined"!=typeof this.pageManager.getUrlParam("hp")&&o.push("hp"),"undefined"!=typeof this.pageManager.getUrlParam("src")&&o.push("src-"+this.pageManager.getUrlParam("src")),"undefined"!=typeof s.options.keywords&&(o=t.union(o,s.chainKeywords(s.options.keywords))),n.data.keywords=t.filter(o,function(e){return!("undefined"==typeof e||""===e)}).join(","),e.sync(i,a,n)},assignDeliveryProofParams:function(e){var i,a,n={};for(i=this.deliveryProofParams.length-1;i>=0;i-=1)a=this.pageManager.getUrlParam(this.deliveryProofParams[i]),"undefined"!=typeof a&&(n[this.deliveryProofParams[i]]=a||"1");return t.extend(e,n)},chainKeywords:function(e){var t,i,a=e.length,n=[],s=this;for(t=0;a>t;t+=1)i=s.adForceLookup[e[t]],n.push(i||e[t]);return"1"===this.pageManager.getUrlParam("rico")&&n.push(this.pageManager.getUrlParam("keywords")),n},parse:function(e){var i=e.ads;return i=t.map(i,function(e,t){var i=e.isInlineSafe;return e.name=t,e.isInlineSafe="Y"===i||"true"===i,e}),"undefined"!=typeof this.pageManager.getUrlParam("debug")&&(window.adx_debug_output=e,
console.log("adx debug page: ",this.options.page),console.log("adx debug positions: ",this.options.positions.join(",")),console.log("adx debug output: ",e),console.log("adx debug keywords: ",this.chainKeywords(this.options.keywords).join(","))),i},getConfirmPixel:function(){return this.confirmPixel?this.confirmPixel.creative:void 0}});return s}),define("shared/ad/templates",["underscore/nyt"],function(_){var templates={};return templates.iFrameStyleSheet=function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<!--\nDEPRECATED - DO NOT USE/MODIFY - USE SHARED/ADLIBRARY INSTEAD\n-->\n<style type="text/css">\nbody {\nmargin: 0;\noverflow: hidden;\n}a img {\nborder: none;\n}\n</style>';return __p},templates.interstitialModal=function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<!--\nDEPRECATED - DO NOT USE/MODIFY - USE SHARED/ADLIBRARY INSTEAD\n-->\n<div id="Interstitial" class="ad interstitial-ad"></div><p class="user-action dismiss-button">Continue &raquo;</p>';return __p},templates.ribbonInterstitial=function(obj){var __p="";Array.prototype.join;with(obj||{})__p+='<!--\nDEPRECATED - DO NOT USE/MODIFY - USE SHARED/ADLIBRARY INSTEAD\n-->\n<div class="ribbon-interstitial-ad-overlay">\n<h4 class="ad-heading"> Advertisement </h4>\n<div id="RibbonInterstitial" class="ad ribbon-interstitial-ad"> </div>\n</div>';return __p},templates}),define("shared/ad/views/ads",["underscore/nyt","jquery/nyt","foundation/views/base-view","foundation/views/ad-view-manager","shared/ad/collections/ads","shared/ad/templates","shared/modal/views/modal"],function(e,t,i,a,n,s,o){"use strict";var r=i.registerView("ads").extend({el:".ad",template:s,pushdownWidth:"970",billboardHeight:"90",navBreakPoint:10040,positions:null,blocking:!1,adShown:{},initialize:function(t){e.bindAll(this,"completeInterstitial","renderAd"),this.options=t||this.options||{},this.positions=[],this.preInitialize(),this.local(this,"nyt:ads-pre-initialize"),this.detectTragedy(),this.setAdParametersOnOptions(),this.scope=this.options.scope||this.scope,this.confirm=!0,this.ads=new n([],this.options),this.subscribe(this.ads,"sync",this.receiveAds),this.secondaryIframeClass="frame-for-"+this.scope,this.listenTo(this.pageManager,"nyt:page-breakpoint",this.responsive),this.postInitialize(),this.local(this,"nyt:ads-post-initialize"),this.subscribe("nyt:ads-new-placement",this.handleRemoteAdRequest),this.subscribe("nyt:ads-fire-ribbon-interstitial",this.fireRibbonInterstitial),this.subscribe("nyt:slideshow-ad",this.fireSlideShowAd),this.addAmazonKeywords?this.getAmazonAds():this.requestAds()},getAmazonAds:function(){window.amznads={updateAds:function(t){window.amazonAdData=t.ads,window.amazonAdSlots=e.keys(window.amazonAdData)},renderAd:function(e,t){var i,a;window.amazonAdData&&window.amazonAdData[t]?(e.write(window.amazonAdData[t]),e.close()):(i={c:"dtb",src:"3030",kvmismatch:1,pubReturnedKey:t,aaxReturnedKeys:window.amazonAdSlots,cb:Math.round(1e7*Math.random()),u:window.encodeURIComponent(window.location.host+window.location.pathname),ua:encodeURIComponent(window.navigator.userAgent)},a=window.encodeURIComponent(JSON.stringify(i)),e.write('<img src="//aax.amazon-adsystem.com/x/px/p/0/'+a+'"/>'),e.close())}},this.getAmazonKeywordsAndRequestAds()},getAmazonKeywordsAndRequestAds:function(){var e=this,i="3030",a=encodeURIComponent(document.location);try{a=encodeURIComponent(""+window.top.location)}catch(n){t.noop()}t.ajax({url:"//aax.amazon-adsystem.com/e/dtb/bid?src="+i+"&u="+a+"&cb="+Math.round(1e7*Math.random()),dataType:"script"}).done(function(){e.addAmazonKeywords()}).always(function(){e.requestAds()})},preInitialize:t.noop,postInitialize:t.noop,responsive:t.noop,setHtmlClasses:t.noop,requestAds:function(){this.options.response?(this.ads.reset(this.ads.parse(this.options.response)),this.ads.trigger("sync")):this.ads.fetch()},receiveAds:function(){this.hasInterstitial()||this.checkAds()},resizeTopAd:e.debounce(function(){var e,i=this.ads.findWhere({name:"TopAd"});i&&(e=i.get("height"),e&&90>e&&t("#TopAd").css("min-height",parseInt(e,10)))},1e3),checkAds:function(){var i,a,n,s,o,r=this;for(this.removeAds(),i=this.getReturnedAdNames(this.pageManager.isDomReady()),this.pageManager.isDomReady()||this.subscribe("nyt:page-ready",function(){r.getReturnedAdNames(!0)}),i&&i.length>0&&(this.pageManager.getMeta("ads_adNames")||this.pageManager.setMeta("ads_adNames",this.returnAdNames())),e.indexOf(i,"TopAd")<0?(o=t("#TopAd"),0===o.length&&o.addClass("hidden")):r.resizeTopAd(),s=this.getPositions(),a=0,n=s.length;n>a;a+=1)t("#"+s[a]).toggleClass("hidden",r.isAdUnavailable(i,s[a]));e.indexOf(this.options.positions,"Middle1C")>=0&&!this.ads.findWhere({name:"Middle1C"})&&t("#TopNavAd, .search-flyout-panel .ad").addClass("hidden"),e.defer(function(){r.broadcast("nyt:ads-rendered",r)}),r.setHtmlClasses(),e.delay(function(){r.loadGoogleAdScript()},1200)},loadGoogleAdScript:function(){var e,i,a;0===t("#SponLink, #SponLinkA, #HPSponLink, #TopAd1, #MiddleRightN").length||this.pageManager.getMeta("googleAdScriptInjected")||(e="script",i=document.createElement(e),a=document.getElementsByTagName(e)[0],i.src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",a.parentNode.insertBefore(i,a),this.pageManager.setMeta("googleAdScriptInjected","true"))},renderAd:function(e){e.page=e.page||this.ads.options.page,e.frameStyle=e.frameStyle||this.template.iFrameStyleSheet(),e.secondaryIframeClass=e.secondaryIframeClass||this.secondaryIframeClass,a.render(e)},renderAdByPositionName:function(i,a){var n=t("#"+i);return a||(a=this.ads.where({name:i})[0]),n.length&&a||"ADX_CLIENTSIDE"===i?(this.isCreativeBlank(a)||n.removeClass("hidden"),e.defer(this.renderAd,{model:a,el:n}),!0):!1},handleRemoteAdRequest:function(e){this.ads.length>0&&this.renderAdByPositionName(e)},getPositions:function(){return this.options.positions},detectTragedy:function(){var e=this.pageManager.getMeta("ad_sensitivity");e&&(this.options.page="www.nytimes.com/"+e)},returnAdNames:function(){return this.ads.pluck("name")},cleanHtmlClasses:function(){this.htmlClasses&&this.$html.removeClass(e.values(this.htmlClasses).join(" "))},isDirectlySold:function(e){var t=this.ads.where({name:e})[0].attributes.isDirectlySold;return"true"===t},returnAdParametersObject:function(){var t=this.pageManager.getUrlParam("ad-keywords"),i=this.pageManager.getUrlParam("ad-positions");return{keywords:e.isString(t)?[t]:t,positions:e.isString(i)?[i]:i}},setAdParametersOnOptions:function(){var t=this.returnAdParametersObject();this.options.keywords=e.union(this.options.keywords,t.keywords),t.positions&&(this.options.positions=t.positions)},isPlaceholderInViewport:function(e){var i;return!e||e&&0===e.length?!1:(i=e.get(0).getBoundingClientRect(),i.top+e.height()>=0&&i.left+e.width()>=0&&i.bottom-e.height()<=t(window).height()&&i.right-e.width()<=t(window).width())},isCreativeBlank:function(e){var t=e.get("classification");return"blank"===t||"blank-but-count-imps"===t},handleApplicationAd:function(e){var t,i;return t=e.get("name"),i=this.renderAdByPositionName(t,e)},getReturnedAdNames:function(e){var t=this,i=[];return e="undefined"!=typeof e?e:!1,this.ads.length>0&&this.ads.each(function(a){e?t.handleApplicationAd(a)?i.push(a.get("name")):t.confirm=!1:i.push(a.get("name"))}),i},isAdUnavailable:function(t,i){return e.indexOf(t,i)<0||this.isCreativeBlank(this.ads.where({name:i})[0])},removeAds:function(){t("."+this.secondaryIframeClass).remove()},isHalfPage:function(e,t){return 300===parseInt(e,10)&&600===parseInt(t,10)},isPushdown:function(e,t){return e===this.pushdownWidth&&t!==this.billboardHeight},handleTopNav:function(i){var a,n,s,o,r=t("#SponsorAd"),l=r.find("iframe"),d=t("#TopNavAd"),h=d.find("iframe");return a=this.ads.findWhere({name:"Middle1C"}),s=i<this.navBreakPoint&&0===l.length,o=i>=this.navBreakPoint&&0===h.length,a&&(s||o)?(s?(n=r,h.remove()):(n=d,l.remove()),e.defer(this.renderAd,{el:n,model:a}),!0):!1},fireSlideShowAd:function(e){var i=this.ads.findWhere({name:e.position}),a=t('<div class="ad-wrapper"></div>');this.adShown[e.position]||"object"!=typeof i||(this.adShown[e.position]=!0,e.el.html(a),this.renderAd({el:a,model:i}),this.broadcast("nyt:slideshow-ad-render",i))},hasInterstitial:function(){var e,t=this.ads.findWhere({name:"Interstitial"});return t?(e=t.get("timeout")?1e3*parseInt(t.get("timeout"),10):15e3,this.createInterstitial(t,this.completeInterstitial,e),!0):!1},fireRibbonInterstitial:function(){var e=this.pageManager.getViewport();this.$shell.prepend(s.ribbonInterstitial()),this.renderAdByPositionName("RibbonInterstitial"),this.$shell.find("#main").addClass("visually-hidden").end().find(".ribbon-interstitial-ad-overlay").css("height",e.height-150).find("iframe").css("width","")},createInterstitial:function(e,t,i){var a=this;this.interstitialModal=new o({id:"interstitial-ad-modal",modalTitle:"advertisement",tailDirection:"fixed",hasOverlay:!0,hasCloseButton:!0,width:e.get("width"),height:e.get("height"),modalContent:s.interstitialModal(),closeCallback:t,openCallback:function(){a.renderAdByPositionName(e.get("name"))}}).addToPage().open(),i&&(a.closeTimeout=window.setTimeout(this.interstitialModal.close,i))},completeInterstitial:function(e){window.clearTimeout(this.closeTimeout),this.interstitialModal.removeFromPage(),this.ads.remove(e),this.checkAds()}});return r}),define("shared/sharetools/helpers/share-tools-config",["underscore/nyt","foundation/views/page-manager"],function(e,t){"use strict";var i={width:600,height:450,adPosition:"Frame4A",overlayAdPosition:"Frame6A",isModalMember:!0,isArticleTool:!1,isInDefaultSet:!1,isPopup:!0,usesShortUrl:!1,shareDataParameters:{},shareServiceParameters:{}},a=function(t){var a=e.extend({},i,t);return Object.freeze?Object.freeze(a):a},n={EMAIL:a({label:"Email",isInDefaultSet:!0,requiresLogin:!0,loginModalTitle:"Log in to email",modalDisplayOrder:1,mobileModalDisplayOrder:1}),FACEBOOK:a({label:"Share",isInDefaultSet:!0,url:"http://www.facebook.com/sharer.php",smid:"fb-share",modalDisplayOrder:3,mobileModalDisplayOrder:2,shareDataParameters:{url:"u"}}),GOOGLE:a({label:"Google+",url:"https://plus.google.com/share",smid:"go-share",height:600,modalDisplayOrder:4,mobileModalDisplayOrder:6,shareDataParameters:{url:"url"},shareServiceParameters:{hl:"en-US"}}),REDDIT:a({label:"Reddit",url:"http://www.reddit.com/submit",smid:"re-share",width:854,height:550,modalDisplayOrder:6,mobileModalDisplayOrder:7,shareDataParameters:{url:"url",title:"title"}}),PINTEREST:a({label:"Pin",url:"https://www.pinterest.com/pin/create/button/",smid:"pin-share",width:750,height:330,modalDisplayOrder:7,mobileModalDisplayOrder:4,shareDataParameters:{url:"url",media:"media",description:"description"}}),TWITTER:a({label:"Tweet",isInDefaultSet:!0,url:"https://twitter.com/share",smid:"tw-share",usesShortUrl:!0,modalDisplayOrder:5,mobileModalDisplayOrder:3,shareDataParameters:{url:"url",title:"text"}}),LINKEDIN:a({label:"Linkedin",url:"http://www.linkedin.com/shareArticle",smid:"li-share",width:750,modalDisplayOrder:2,mobileModalDisplayOrder:5,shareDataParameters:{url:"url",title:"title",description:"summary"},shareServiceParameters:{mini:"true",source:"The New York Times"}}),SAVE:a({label:"Save",isInDefaultSet:!0,isArticleTool:!0,loginModalTitle:"Log in to save",modalDisplayOrder:1}),PRINT:a({label:"Print",isModalMember:"interactive"!==t.getApplicationName(),isArticleTool:"interactive"!==t.getApplicationName(),modalDisplayOrder:3,shareServiceParameters:{pagewanted:"print"}}),REPRINTS:a({label:"Reprints",width:930,height:850,isArticleTool:!0,isModalMember:!0,url:"http://www.nytreprints.com",modalDisplayOrder:2}),EMBED:a({label:"Embed",isArticleTool:!1,isInDefaultSet:!1,isModalMember:!1}),"SHOW-ALL":a({label:"More",isInDefaultSet:!0,isModalMember:!1,isModalTrigger:!0}),AD:a({label:"Advertisement",isInDefaultSet:!0,isModalMember:!1})};return Object.freeze?Object.freeze(n):n}),define("shared/sharetools/templates",["underscore/nyt"],function(_){var templates={};return templates.emailModal=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<iframe src="'+(null==(__t=emailThisUrl)?"":__t)+(null==(__t=dataUrl)?"":__t)+'" title="Email This" id="emailthis" scrolling="'+(null==(__t=scrolling)?"":__t)+'" marginheight="0" marginwidth="0" frameborder="0"></iframe>';return __p},templates.savemodal=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<ul class="instructions">\n<li>This item has been saved to read later from any device. </li>\n<li>Access saved items through your user name at the top of the page.</li>\n</ul>\n<p><a href="'+(null==(__t=link)?"":__t)+'">View Saved Items</a><p>\n<button class="button dismiss-button">OK</button>';return __p},templates.shareTool=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<a href="javascript:;" data-share="'+(null==(__t=id)?"":__t)+'" data-modal-title="'+(null==(__t=loginModalTitle)?"":__t)+'"><i class="icon sprite-icon"></i><span class="sharetool-text '+(null==(__t=isLabelHidden===!0?"visually-hidden":"")?"":__t)+'">'+(null==(__t=label)?"":__t)+"</span></a>";return __p},templates.shareTools=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+="<ul>\n",_.each(shares,function(e){__p+='\n<li class="sharetool '+(null==(__t=e.type)?"":__t)+"-sharetool "+(null==(__t=config[e.type].loginRequired?"login-modal-trigger":"")?"":__t)+'" data-modal-title="'+(null==(__t=config[e.type].loginModalText||"")?"":__t)+'">\n<a href="javascript:;" data-share="'+(null==(__t=e.type)?"":__t)+'"><i class="icon sprite-icon"></i><span class="sharetool-text">'+(null==(__t=e.label)?"":__t)+"</span></a>\n</li>\n"}),__p+="\n</ul>";return __p},templates.shareToolsModal=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="section share ',isCompact&&(__p+="compact-share-tools"),__p+='">\n<ul class="sharetools-menu">\n'+(null==(__t=standardToolsList)?"":__t)+'\n</ul>\n<form class="short-url-form">\n<div class="control">\n<div class="label-container"><label for="short-url-input">Permalink</label></div>\n<div class="field-container">\n<input id="short-url-input" class="short-url-input text" type="text" name="short-url-input" value="'+(null==(__t=shortUrl)?"":__t)+'" readonly="readonly" />\n</div>\n</div>\n</form>\n',isCompact&&showTools&&(__p+='\n<form class="embed-url-form">\n<div class="control">\n<div class="label-container"><label for="embed-input">Embed</label></div>\n<div class="field-container">\n<input id="embed-input" class="embed-input text" type="text" name="embed-input" readonly="readonly" />\n</div>\n</div>\n</form>\n'),__p+="\n</div><!--close section -->\n",!isCompact&&showTools&&(__p+='\n<div class="section tools">\n<h4 class="modal-heading">Tools</h4>\n<ul class="sharetools-menu">\n'+(null==(__t=articleToolsList)?"":__t)+"\n</ul>\n</div><!--close section -->\n"),__p+="";return __p},templates.shareToolsModalFooter=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="ad show-all-sharetool-modal-ad hidden">\n<small class="ad-sponsor">'+(null==(__t=toolTypeSponsor)?"":__t)+" Tools Sponsored By</small>\n</div>";return __p},templates.showAllSharetoolCompactModal=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="section share">\n<ul class="sharetools-menu">\n'+(null==(__t=showAllLinkList)?"":__t)+'\n</ul>\n</div> <!--close section -->\n<div class="section tools">\n<ul class="sharetools-menu">\n'+(null==(__t=showAllToolList)?"":__t)+'\n</ul>\n<div class="control permalink-control">\n<div class="label-container">\n<label for="permalink-input" class="sharetools-label">Permalink</label>\n</div>\n<div class="field-container">\n<input id="permalink-input" type="text" class="text short-url-input" placeholder="" readonly="readonly" />\n<span class="textbox-fade"></span>\n</div>\n</div><!-- close control -->\n<div class="control embed-control">\n<div class="label-container">\n<label for="embed-input" class="sharetools-label">Embed</label>\n</div>\n<div class="field-container">\n<input id="embed-input" type="text" class="text embed-input" placeholder="" readonly="readonly" />\n<span class="textbox-fade"></span>\n</div>\n</div><!-- close control -->\n</div><!--close section -->';return __p},templates.showAllSharetoolModal=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<div class="section share">\n<ul class="sharetools-menu">\n'+(null==(__t=showAllLinkList)?"":__t)+'\n</ul>\n<form class="short-url-form">\n<div class="control">\n<div class="label-container"><label for="short-url-input">Permalink</label></div>\n<div class="field-container">\n<input id="short-url-input" class="short-url-input text" type="text" name="short-url-input" value="'+(null==(__t=shortUrl)?"":__t)+'" readonly="readonly" />\n</div>\n</div>\n</form>\n</div> <!--close section -->\n<div class="section tools">\n<h5 class="modal-heading">Tools</h5>\n<ul class="sharetools-menu">\n'+(null==(__t=showAllToolList)?"":__t)+"\n</ul>\n</div><!--close section -->";return __p},templates.showallLinks=function(obj){var __t,__p="";Array.prototype.join;with(obj||{})__p+='<li class="sharetool '+(null==(__t=shareObj.type)?"":__t)+"-sharetool "+(null==(__t=config.loginRequired?"login-modal-trigger":"")?"":__t)+'" data-modal-title="'+(null==(__t=config.loginModalText||"")?"":__t)+'">\n<a href="javascript:;" data-share="'+(null==(__t=shareObj.type)?"":__t)+'"><i class="icon sprite-icon"></i>'+(null==(__t=shareObj.label)?"":__t)+"</a>\n</li>";return __p},templates}),define("shared/sharetools/views/email",["jquery/nyt","underscore/nyt","foundation/hosts","foundation/views/base-view","shared/modal/views/modal","shared/sharetools/templates"],function(e,t,i,a,n,s){"use strict";var o=a.extend({template:s.emailModal,className:"email-view-container",frameSize:{small:507,full:867,ad:285},defaultSettings:{emailThisUrl:"https:"+i.www+"/mem/email-this.html?url=",scrolling:window.Modernizr.postmessage?"no":"yes"},defaultModalSettings:{id:"email-share-modal",modalTitle:"Email This Article",binding:".email-sharetool",tailDirection:"centered",hasOverlay:!0,hasCloseButton:!0,modalContent:""},initialize:function(e){var i=this;t.bindAll(this,"handlePostMessage","responsive"),this.settings=t.extend({},this.defaultSettings,e),this.frameState="full",this.modalSettings=t.extend({},this.defaultModalSettings,{openCallback:function(){window.Modernizr.postmessage&&(window.addEventListener?window.addEventListener("message",i.handlePostMessage,!1):window.attachEvent("onmessage",i.handlePostMessage)),i.listenTo(i.pageManager,"nyt:page-breakpoint",i.responsive)},closeCallback:function(){this.removeFromPage(),window.addEventListener?window.removeEventListener("message",i.handlePostMessage,!1):window.detachEvent("onmessage",i.handlePostMessage),i.stopListening(i.pageManager,"nyt:page-breakpoint",i.responsive)}}),this.prepareUrls(),this.render()},render:function(){this.modalSettings.modalContent=this.template(this.settings),this.emailModal=new n(this.modalSettings),this.emailModal.addToPage(),t.defer(this.responsive,this.pageManager.getCurrentBreakpoint())},responsive:function(e){var t=this.emailModal.$modal.find("iframe");1010>=e&&"full"===this.frameState&&(t.css("height",t.height()+this.frameSize.ad+"px").width(this.frameSize.small),this.frameSize.state="small",this.emailModal.positionDialog()),e>1010&&"small"===this.frameState&&(t.css("height",t.height()-this.frameSize.ad+"px").width(this.frameSize.full),this.frameState="full",this.emailModal.positionDialog())},handlePostMessage:function(e){var t;/\.nytimes\.com$/.test(e.origin)&&(t=e.data.match(/(.+)\:(.+)/),t&&"frameheight"===t[1]?this.$el.css("height",t[2]):t&&"closewindow"===t[1]?this.emailModal.close():t&&"loginredirect"===t[1]&&(window.location=i.myaccount+"/auth/login?URI="+encodeURIComponent(window.location.href)))},prepareUrls:function(){"string"==typeof this.settings.dataUrl&&-1===this.settings.dataUrl.indexOf("http")&&(this.settings.dataUrl="http:"+i.www+this.settings.dataUrl)}});return o}),define("shared/sharetools/models/saved-article",["jquery/nyt","underscore/nyt","backbone/nyt","foundation/models/base-model"],function(e,t,i,a){"use strict";var n=a.extend({getSummary:function(){return this.get("Data")?this.get("Data").Summary:""},getByline:function(){return this.get("Data")?this.get("Data").Byline:""},getTitle:function(){return this.get("Data")?this.get("Data").Headline:this.get("URL")},getUrl:function(){return this.get("URL")},getDate:function(){return this.get("CreatedDate")},getFormattedDate:function(){var e=new Date(this.getDate());return this.dateHelper.getMonthShortName(e.getMonth())+" "+e.getDate()+", "+e.getFullYear()},getThumbUrl:function(){return this.get("Data")?this.get("Data").ImageCrops.MediumThreeByTwo210:""},getCaption:function(){var e="";return this.get("Data")&&(e=this.get("Data").ImageCaption),e},getCaptionStripTags:function(){return this.getCaption().replace(/<\/?[^>]+>/gi,"")},hasThumb:function(){return!!this.getThumbUrl()}});return n}),define("shared/sharetools/collections/cross-platform-save",["jquery/nyt","underscore/nyt","backbone/nyt","foundation/collections/base-collection","foundation/hosts","foundation/lib/auth/userauth","shared/sharetools/models/saved-article"],function(e,t,i,a,n,s,o){"use strict";var r=a.extend({model:o,offset:0,limit:20,apiCommand:{save:"POST",list:"GET",remove:"DELETE"},url:n.readingListApiHost+"/reading-list/v2",currentArticleSaved:!1,save:function(e){var t=this,i={data:JSON.stringify({URL:e})};this.sync(this.apiCommand.save,i).done(function(i){t.articleIsSaved(!0),t.add(i.Assets),t.trigger("nyt:xps-saved",e,i.Assets)}).fail(function(){t.trigger("nyt:xps-failed",e)})},removeSavedArticle:function(e){var t=this,i={data:JSON.stringify({URL:e})};this.sync(this.apiCommand.remove,i).done(function(i){t.articleIsSaved(!1),t.remove(i),t.trigger("nyt:xps-article-removed",e,i)}).fail(function(){t.trigger("nyt:xps-failed",e)})},getSavedArticles:function(){var e=this,t={data:{offset:this.offset,limit:this.limit},url:this.url+"/data"};e.reset(),this.sync(this.apiCommand.list,t).done(function(t){e.add(t.Assets),e.totalCount=t.OverallSummary.Count,e.trigger("nyt:xps-articles-loaded",t.Assets)}).fail(function(){e.trigger("nyt:xps-load-failed")})},getNextSavedArticles:function(){return this.offset+=this.limit,this.limit=10,this.totalCount>this.offset?(this.getSavedArticles(),this.totalCount<=this.offset+this.limit&&this.trigger("nyt:xps-finished"),!0):!1},getArticlesStatus:function(e){var t=this,i={data:{url:e},url:this.url+"/active"};this.sync(this.apiCommand.list,i).done(function(e){t.articleIsSaved(e.length)}).fail(function(){t.broadcast("nyt:xps-load-failed")})},articleIsSaved:function(e){this.currentArticleSaved=e,this.broadcast("nyt:xps-article-status",e)},sync:function(i,a){var n=new e.Deferred,o=setTimeout(function(){n.reject()},5e3),r={type:i,dataType:"json",contentType:"application/json",url:this.url,headers:{},xhrFields:{withCredentials:!0},success:function(e){clearTimeout(o),e?n.resolve(e):n.reject()}};return s.getToken().done(function(i,n,s){i&&n&&"undefined"!=typeof s&&(r.headers["X-Requested-By"]=i),e.ajax(t.extend(r,a))}),n.promise()}});return r}),define("shared/sharetools/instances/cross-platform-save",["shared/sharetools/collections/cross-platform-save"],function(e){"use strict";return new e}),define("shared/sharetools/collections/short-url",["jquery/nyt","backbone/nyt","foundation/collections/base-collection","foundation/hosts"],function(e,t,i,a){"use strict";var n=i.extend({url:a.shortenHost+"/svc/bitly/shorten.jsonp",initialize:function(){this.currentUrlRequest="",this.addCurrentPage()},sync:function(e,i,a){return a.dataType="jsonp",a.jsonpCallback="shortUrlCallback",a.jsonp="callback",a.cache=!0,a.data={url:this.currentUrlRequest},t.sync(e,i,a)},parse:function(e){return{url:this.currentUrlRequest,shortUrl:e.payload?e.payload.short_url:""}},addCurrentPage:function(){var t,i=this.pageManager.getCanonical();t="1"===this.pageManager.getUrlParam("rico")&&"undefined"!=typeof this.pageManager.getUrlParam("share_url")?this.pageManager.getUrlParam("share_url"):e("#masthead").find(".story-short-url").text(),i&&t&&this.add({url:i,shortUrl:t})},getRicoUrl:function(e){var t=this.pageManager.getUrlParam("share_url"),i=document.createElement("a");return i.href=e,i.pathname===location.pathname&&t&&7===t.indexOf("r-i.co/")?t:void 0},requestUrl:function(e){var t,i=this.findWhere({url:e});return i?i.get("shortUrl"):(t=this.getRicoUrl(e))?t:(this.currentUrlRequest=e,void this.fetch())}});return n}),define("shared/sharetools/instances/short-url",["shared/sharetools/collections/short-url"],function(e){"use strict";return new e}),define("shared/sharetools/views/common-mixin",["jquery/nyt","underscore/nyt","foundation/hosts","foundation/models/user-data","foundation/models/page-storage","foundation/tracking/tracking-mixin","shared/modal/views/modal","shared/sharetools/templates","shared/sharetools/views/email","shared/sharetools/helpers/share-tools-config","shared/sharetools/instances/cross-platform-save","shared/sharetools/instances/short-url"],function(e,t,i,a,n,s,o,r,l,d,h,c){"use strict";var u={handleShareAction:function(t,i){var n=e(t.target),s=n.attr("data-share")||n.parent().attr("data-share"),o=s&&d[s.toUpperCase()];return o?(i&&this.modal&&this.modal.close(),"imageslideshow"!==this.pageManager.getMeta("PT")&&this.trackShareData(s,o,i),o===d.EMBED?void this.triggerEmbedLoginModal(t):void(o.isModalTrigger?this.broadcast("nyt:open-share-modal",{instanceContainer:this.$instanceContainer}):o===d.EMAIL?this.isMobileShareTools()?this.openMailToLink():a.isLoggedIn()?new l({dataUrl:this.shareData.getUrl()}):this.triggerLoginModal(t,"Log in to email","Email"):o===d.PRINT?window.print():o===d.SAVE?a.isLoggedIn()?h.currentArticleSaved?this.removeItem():this.saveItem():(this.trackingTrigger("loginmodal-open",{module:"LogIn",action:"Click",region:i?"ToolsMenu":this.trackingRegion,eventName:"ArticleTool-save"}),this.triggerLoginModal(t,"Log in to save","Save")):o.isPopup&&this.popupShareWindow(o))):void 0},handleModalShareAction:function(e){this.handleShareAction(e,!0)},triggerLoginModal:function(e,t,i){e.preventDefault(),e.stopPropagation(),this.broadcast("nyt:loginmodal-open",{modalTitle:t,moduleName:i})},triggerEmbedLoginModal:function(t){t.stopPropagation(),e(".show-all-sharetool a").trigger("click"),this.$body.find(".show-all-sharetool-modal #embed-input").select()},popupShareWindow:function(e){e.usesShortUrl?this.handleShortUrlShareAction(e):window.open(this.buildShareServiceUrl(e),"_blank",this.getPopupWindowFeatures(e))},getPopupWindowFeatures:function(e){return"toolbar=0,status=0,height="+e.height+",width="+e.width+",scrollbars=yes,resizable=yes"},buildShareServiceUrl:function(e){var t,i=[],a=e.smid,n=e.shareDataParameters,s=e.shareServiceParameters,o={url:this.shareData.getUrl(),title:this.shareData.getTitle(),description:this.shareData.getDescription(),media:this.shareData.getMedia()};if(a&&(o.url+=this.getQuerystringDelimiter(o.url),o.url+="smid="+a),n)for(t in n)n.hasOwnProperty(t)&&o.hasOwnProperty(t)&&i.push(n[t]+"="+encodeURIComponent(o[t]));if(s){s.hasOwnProperty("publicationDate")&&(s.publicationDate=this.shareData.getPublicationDate()),s.hasOwnProperty("author")&&(s.author=this.shareData.getAuthor());for(t in s)s.hasOwnProperty(t)&&i.push(t+"="+encodeURIComponent(s[t]))}return e.url+"?"+i.join("&")},handleShortUrlShareAction:function(t){var i,a,n,s,o=this,r=this.shareData.getUrl(),l=t.smid;/(?:iPad|iPhone)/.test(navigator.userAgent)?(s=e("#masthead").find(".story-short-url").text()||this.pageManager.getCanonical()||r,i=t.url+"?url="+encodeURIComponent(s)+"&text="+encodeURIComponent(o.shareData.getTitle()),window.open(i,"_blank",this.getPopupWindowFeatures(t))):(a=window.open("","_blank",this.getPopupWindowFeatures(t)),n=function(e){var i=o.shareData.getVia();e=t.url+"?url="+encodeURIComponent(e)+"&text="+encodeURIComponent(o.shareData.getTitle()),i&&(e+="&via="+encodeURIComponent(i)),a.location.href=e},l&&!this.pageManager.isMobile()&&(r+=this.getQuerystringDelimiter(r),r+="smid="+l),i=c.requestUrl(r)||"",i?n(i):this.listenToOnce(c,"add",function(){var e=c.findWhere({url:r});e&&n(e.get("shortUrl"))}))},getQuerystringDelimiter:function(e){return-1===e.indexOf("?")?"?":"&"},saveItem:function(){var e,t,a,s,o=this,l=this.shareData.getUrl();t=function(){var e="sharetools_hasSaves";n.get(e)!==!0?(s(),n.set(e,!0)):a()},a=function(){o.showModal({id:"save-item-growl-modal",modalTitle:'<i class="icon"></i>Saved',tailDirection:"centered",openCallback:function(){window.setTimeout(this.removeFromPage,2e3)}})},s=function(){o.showModal({id:"save-item-modal",modalTitle:'<i class="icon"></i>Saved',modalContent:r.savemodal({link:i.www+"/saved"}),hasOverlay:!0,hasCloseButton:!0,tailDirection:"centered",closeCallback:function(){this.removeFromPage()}})},e=h.where({url:l}),e.length?a():(this.subscribeOnce(h,"nyt:xps-saved",t),h.save(l))},removeItem:function(){var e=this,t=this.shareData.getUrl(),i=function(){e.showModal({id:"save-item-growl-modal",modalTitle:'<i class="icon"></i>Removed',tailDirection:"centered",openCallback:function(){window.setTimeout(this.removeFromPage,2e3)}})};this.subscribeOnce(h,"nyt:xps-article-removed",i),h.removeSavedArticle(t)},trackShareData:function(e,t,i){var a={};h.currentArticleSaved&&(e="unsave"),this.trackingBaseData={module:"ShareTools",action:"click",version:this.shareData.getContentType(),contentCollection:this.pageManager.getMeta("article:section")},i?(a.region="ToolsMenu",a.version="Content"):a.region=this.trackingRegion,t.isArticleTool?(a.module="ArticleTools",a.eventName="ArticleTool-"+e):"show-all"===e?a.eventName="Share-ShowAll":a.eventName="Share-"+e,this.trackingTrigger("share-tools-click",a)},showModal:function(e){var i=new o(e);i.addToPage(),t.defer(i.open)},isMobileShareTools:function(){return this.pageManager.getCurrentBreakpoint()<1e3},openMailToLink:function(){var e="%0A%0A",t=encodeURIComponent(this.shareData.getTitle()),i=encodeURIComponent(this.shareData.getDescription()),a=encodeURIComponent(this.shareData.getUrl()),n="NYTimes.com: "+t,s="From The New York Times:"+e+t+e+i+e+a;window.location="mailto:?subject="+n+"&body="+s}};return u}),define("shared/sharetools/views/share-tool",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/sharetools/views/common-mixin","shared/sharetools/templates"],function(e,t,i,a,n){"use strict";var s=i.extend(t.extend({},a,{tagName:"li",events:{click:"handleShareAction"},initialize:function(e){this.toolId=e.toolId,this.toolConfig=e.toolConfig,this.label=e.customLabel||this.toolConfig.label,this.loginModalTitle=this.toolConfig.loginModalTitle||"",this.$instanceContainer=e.instanceContainer,this.shareData=e.shareData,this.trackingRegion=e.trackingRegion,""===e.customLabel&&(this.isLabelHidden=!0)},render:function(){var e,t,i=this.toolId.toLowerCase();return this.isAdView()?(e=this.pageManager.getCurrentBreakpoint()<=1020?"Position1":"Frame4A",this.$instanceContainer.find(".sharetools-inline-article-ad").attr("id",e),this.broadcast("nyt:ad-library:dfp:queue-placement",e),this.$instanceContainer.find("#"+e).removeClass("hidden")):(t=n.shareTool({id:i,label:this.label,loginModalTitle:this.loginModalTitle,isLabelHidden:this.isLabelHidden}),this.$el.addClass("sharetool "+i+"-sharetool"),this.$el.append(t)),this},isAdView:function(){return"AD"===this.toolId}}));return s}),define("shared/sharetools/views/containers-mixin",["jquery/nyt","underscore/nyt","shared/sharetools/models/share-data","shared/sharetools/views/share-tool","shared/sharetools/helpers/share-tools-config"],function(e,t,i,a,n){"use strict";var s={getToolIdsAndCustomLabels:function(e){var t,i,a,s;if(this.toolIds=[],this.customLabels={},e)for(e=e.split(","),t=0,a=e.length;a>t;t++)i=e[t].toUpperCase(),s=i.indexOf("|"),-1!==s&&(i=i.substring(0,s),this.customLabels[i]=e[t].substr(s+1)),this.toolIds.push(i);else for(i in n)n.hasOwnProperty(i)&&n[i].isInDefaultSet===!0&&this.toolIds.push(i);
},instantiateViews:function(e){var i,s,o,r,l,d=[];for(i=0,s=e.length;s>i;i++)o=e[i],r=this.customLabels&&this.customLabels[o],n.hasOwnProperty(o)&&(l={toolId:o,toolConfig:n[o],instanceContainer:this.$instanceContainer,shareData:this.shareData,trackingRegion:this.trackingRegion},t.isString(r)&&(l.customLabel=r),d.push(new a(l)));return d},renderToolViews:function(){var e,t,i;for(t=this.instantiateViews(this.toolIds),e=0,i=t.length;i>e;e++)t[e].isAdView()?t[e].render():this.$el.append(t[e].render().el)},getToolViewsMarkup:function(t){var i,a=document.createElement("div"),n=this.instantiateViews(t),s=n.length;for(i=0;s>i;i++)a.appendChild(n[i].render().el);return e(a).html()}};return s}),define("shared/sharetools/views/share-tools-modal-container",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/views/modal","shared/ad/views/ads","shared/sharetools/helpers/share-tools-config","shared/sharetools/views/share-tool","shared/sharetools/views/common-mixin","shared/sharetools/views/containers-mixin","shared/sharetools/instances/short-url","shared/sharetools/templates"],function(e,t,i,a,n,s,o,r,l,d,h){"use strict";var c=i.extend(t.extend({},r,l,{events:{click:"handleModalShareAction"},defaultModalSettings:{id:"show-all-sharetool-modal",modalTitle:"share",binding:".show-all-sharetool",tailDirection:"up",hasOverlay:!1,hasCloseButton:!1,positionTailSide:!1,autoPosition:!1,modalContent:"",toolTypeSponsor:"Share",tailLeftOffset:0,tailTopOffset:0,openCallback:function(){this.$target.addClass("active")},closeCallback:function(){this.$target.removeClass("active"),this.removeFromPage()}},initialize:function(i){this.$instanceContainer=i.instanceContainer,this.trackingRegion=i.trackingRegion,this.shareData=i.shareData,this.configIds=i.modalSettings.shares,this.showTools=i.modalSettings.hasOwnProperty("showTools")?i.modalSettings.showTools:!0,this.modalSettings=t.extend({},this.defaultModalSettings,i.modalSettings),this.modalSettings.modalFooter=h.shareToolsModalFooter({toolTypeSponsor:this.modalSettings.toolTypeSponsor}),this.isMobileShareTools()&&(this.modalSettings=t.extend({},this.modalSettings,{tailDirection:"centered",hasCloseButton:!0,hasOverlay:!0,positionTailSide:!1,autoPosition:!1})),this.el=document.createElement("ul"),this.el.className="sharetools-menu",this.$el=e(this.el),this.urlWithSmid=this.shareData.getUrl(),this.urlWithSmid+=-1===this.urlWithSmid.indexOf("?")?"?":"&",this.urlWithSmid+="smid=pl-share",this.permalink=d.requestUrl(this.urlWithSmid)||"",this.permalink||this.listenToOnce(d,"add",this.handleShortUrl),this.render()},render:function(){var e="Frame6A",t=this;this.modalSettings.modalContent=h.shareToolsModal(this.buildMarkup()),this.modal=new a(this.modalSettings),this.setElement(this.modal.$modal),this.modalSettings.embedCode&&this.modal.$modal.find(".embed-input").val(this.modalSettings.embedCode),this.modal.$modal.find(".show-all-sharetool-modal-ad").attr("id",e),this.modalSettings.articleSaved&&this.modal.$modal.find(".save-sharetool").addClass("article-saved"),this.modal.addToPage(),this.isMobileShareTools()||this.broadcast("nyt:ad-library:dfp:request-placement",e),this.subscribe("nyt:page-resize",function(){t.modal.close()})},buildMarkup:function(){var i,a,n,o=this,r=[],l=[],d=function(e){var i;s.hasOwnProperty(e)&&(i=t.extend({},s[e],{id:e}),s[e].isArticleTool?"REPRINTS"===e?"article"!==o.pageManager.getMeta("PT")||/\/(?:aponline|reuters|opinion|t-magazine|magazine)\//.test(o.shareData.getUrl())||"books"===o.pageManager.getMeta("CG")&&"Review"===o.pageManager.getMeta("tom")||l.push(i):s[e].isArticleTool&&l.push(i):r.push(i))};if(this.configIds)for(this.getToolIdsAndCustomLabels(this.configIds),i=0,n=this.toolIds.length;n>i;i++)d(this.toolIds[i]);else{for(a in s)s[a].isModalMember&&d(a);r=t.sortBy(r,function(t){return e("html").hasClass("viewport-medium")?t.modalDisplayOrder:t.mobileModalDisplayOrder}),l=t.sortBy(l,function(t){return e("html").hasClass("viewport-medium")?t.modalDisplayOrder:t.mobileModalDisplayOrder})}return{shortUrl:this.permalink,showTools:this.showTools,isCompact:"homepage"===o.pageManager.getApplicationName(),standardToolsList:this.getToolViewsMarkup(t.pluck(r,"id")),articleToolsList:this.getToolViewsMarkup(t.pluck(l,"id"))}},handleShortUrl:function(){var e=d.findWhere({url:this.urlWithSmid});e&&this.modal.$modal.find(".short-url-input").val(e.get("shortUrl"))}}));return c}),define("shared/sharetools/views/share-tools-container",["jquery/nyt","underscore/nyt","foundation/views/base-view","foundation/models/user-data","shared/sharetools/models/share-data","shared/sharetools/views/containers-mixin","shared/sharetools/views/share-tools-modal-container","shared/sharetools/instances/cross-platform-save"],function(e,t,i,a,n,s,o,r){"use strict";var l=i.extend(t.extend({},s,{initializedAttribute:"data-share-tools-initialized",initialize:function(t){this.$instanceContainer=t.el,this.trackingRegion=t.trackingRegion||"",this.$instanceContainer&&!this.$instanceContainer.attr(this.initializedAttribute)&&(this.getToolIdsAndCustomLabels(this.$instanceContainer.data("shares")),this.shareData=new n(this.$instanceContainer),this.el=document.createElement("ul"),this.$el=e(this.el),this.$el.addClass("sharetools-menu"),t.modalSettings&&(this.subscribe("nyt:xps-article-status",function(e){t.modalSettings.articleSaved=e}),a.isLoggedIn()&&r.getArticlesStatus(this.pageManager.getCanonical()),this.subscribe("nyt:open-share-modal",function(e){e.instanceContainer&&this.$instanceContainer.get(0)===e.instanceContainer.get(0)&&new o({instanceContainer:e.instanceContainer,modalSettings:t.modalSettings,trackingRegion:this.trackingRegion,shareData:this.shareData})})),this.render())},render:function(){var i,a,n=void 0!==t.find(this.toolIds,function(e){return"AD"===e}),s=this.$instanceContainer.find(".sharetools-inline-article-ad");this.renderToolViews(),this.$instanceContainer.attr(this.initializedAttribute,"1"),n&&s.length?this.$el.insertBefore(s):this.$instanceContainer.append(this.el),i=this.$el.closest(".sharetools"),a=i.attr("id"),("sharetools-masthead"===a&&(this.isTemplateMinimal()||this.hasCoverMedia())||i.data("share-label"))&&e("#sharetools-masthead .show-all-sharetool .sharetool-text").text("Share")},isTemplateMinimal:function(){return this.$html.hasClass("template-minimal")?!0:void 0},hasCoverMedia:function(){return this.$html.hasClass("has-cover-media")?!0:void 0}}));return l}),define("paidpost/views/share-tools-container",["jquery/nyt","underscore/nyt","shared/sharetools/models/share-data","shared/sharetools/views/share-tools-modal-container","shared/sharetools/views/share-tools-container"],function(e,t,i,a,n){"use strict";var s=n.extend({initialize:function(t){this.$instanceContainer=t.el,this.trackingRegion=t.trackingRegion||"",this.$instanceContainer&&!this.$instanceContainer.attr(this.initializedAttribute)&&(this.getToolIdsAndCustomLabels(this.$instanceContainer.data("shares")),this.shareData=new i(this.$instanceContainer),this.el=e("#sharetools-list")[0]||this.$instanceContainer.find("ul")[0]||document.createElement("ul"),this.$el=e(this.el),t.modalSettings&&this.subscribe("nyt:open-share-modal",function(e){e.instanceContainer&&this.$instanceContainer.get(0)===e.instanceContainer.get(0)&&new a({instanceContainer:e.instanceContainer,modalSettings:t.modalSettings,trackingRegion:this.trackingRegion,shareData:this.shareData})}),this.render())}});return s}),define("shared/sharetools/helpers/sharetools-config",[],function(){"use strict";var e={};return e.common={mainClassName:"shareTools",itemClassName:"shareToolsItem",defaultActiveShares:"email,facebook,twitter,save,show-all|more,ad",defaultShowAllShares:"facebook|Share,email|Email,twitter|Tweet,linkedin|LinkedIn,google|Google+,reddit|Reddit,save|Save,reprints|Reprints,print|Print,ad",defaultUrl:window.location.href.replace(/#.*/,""),defaultTitle:document.title,defaultDescription:"",defaultAdPosition:"Frame4A",defaultOverlayAdPosition:"Frame6A",defaultWidth:600,defaultHeight:450,defaultTransition:"fade",labelSpecialChar:"|",hasAd:!1,loadedAdPositions:[],shortUrlApi:"http://www.nytimes.com/svc/bitly/shorten.jsonp",emailThisUrl:"https://www.nytimes.com/mem/email-this.html?url=",count:0},e.tools={facebook:{active:!0,onShowAll:!0,label:"Facebook",postUrl:"http://www.facebook.com/sharer.php",postType:"popup",shareParameters:{url:"u"},smid:"fb-share",width:655,height:430},twitter:{active:!0,onShowAll:!0,label:"Twitter",postUrl:"https://twitter.com/share",postType:"popup",shareParameters:{url:"url",title:"text",via:"via"},smid:"tw-share",width:600,height:450},google:{active:!0,onShowAll:!0,label:"Google+",postUrl:"https://plus.google.com/share",postType:"popup",shareParameters:{url:"url"},urlParameters:{hl:"en-US"},smid:"go-share",width:600,height:600},tumblr:{active:!0,onShowAll:!0,label:"Tumblr",postUrl:"http://www.tumblr.com/share/link",postType:"popup",shareParameters:{url:"url",title:"name",description:"description"},smid:"tu-share",width:560},linkedin:{active:!0,onShowAll:!0,label:"Linkedin",postUrl:"http://www.linkedin.com/shareArticle",postType:"popup",shareParameters:{url:"url",title:"title",description:"summary"},urlParameters:{mini:"true",source:"The New York Times"},smid:"li-share",width:750,height:450},reddit:{active:!0,onShowAll:!0,label:"Reddit",postUrl:"http://www.reddit.com/submit",postType:"popup",shareParameters:{url:"url",title:"title"},smid:"re-share",width:854,height:550},email:{loginModalText:"Log in to email",active:!0,onShowAll:!0,label:"Email",loginRequired:!0},permalink:{active:!0,onShowAll:!0,label:"Permalink",postUrl:"http://www.nytimes.com/export_html/common/new_article_post.html",postType:"popup",shareParameters:{url:"url",title:"title",description:"summary"},smid:"pl-share",width:460,height:380,loginRequired:!1},"show-all":{active:!0,onShowAll:!1,label:"Show All"},reprints:{active:!0,onShowAll:!1,label:"Reprints",postUrl:"https://s100.copyright.com/AppDispatchServlet",postType:"popup",shareParameters:{url:"contentID"},urlParameters:{publisherName:"The New York Times",publication:"nytimes.com",token:"",orderBeanReset:"true",postType:"",wordCount:"",title:document.title,publicationDate:"",author:""}},save:{loginModalText:"Log in to save",active:!0,onShowAll:!1,label:"Save",postUrl:e.common.defaultUrl.replace(/\?.*/,""),loginRequired:!0},print:{active:!0,onShowAll:!1,label:"Print",postUrl:e.common.defaultUrl,postType:"link",urlParameters:{pagewanted:"print"}},ad:{active:!0,onShowAll:!1,label:"Advertisement"},embed:{active:!0,onShowAll:!0,label:"Embed",loginRequired:!1},pinterest:{active:!0,onShowAll:!0,label:"Pinterest",postUrl:"https://www.pinterest.com/pin/create/button/",postType:"popup",shareParameters:{url:"url",media:"media",description:"description"},smid:"pin-share",width:600,height:450,loginRequired:!1}},e}),define("shared/sharetools/helpers/sharetools-mixin",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/sharetools/templates","shared/ad/views/ads","shared/sharetools/views/email","shared/modal/views/modal","shared/sharetools/instances/cross-platform-save","foundation/models/page-storage","foundation/hosts","foundation/models/user-data","shared/sharetools/helpers/sharetools-config","shared/sharetools/instances/short-url"],function(e,t,i,a,n,s,o,r,l,d,h,c,u){"use strict";var m={getDataAttrs:function(e,i){var a,n,s,o=i||this.$el.data(),r=(o.shares||c.common[e?"defaultShowAllShares":"defaultActiveShares"]).split(","),l=[],d=c.common.hasAd;for(e&&(c.common.defaultUrl.indexOf("aponline")>-1||c.common.defaultUrl.indexOf("reuters")>-1||c.common.defaultUrl.indexOf("magazine")>-1||c.common.defaultUrl.indexOf("t-magazine")>-1)&&(r=t.without(r,"reprints|Reprints")),n=0,s=r.length;s>n;n+=1)r[n].indexOf("|")>0?(a=r[n].split("|"),l.push({type:a[0],label:a[1]})):"ad"===r[n]?d=!0:l.push({type:r[n],label:r[n]});return c.tools.reprints.urlParameters.publicationDate=o.publishDate,t.extend({},{inlineTools:l,ad:d,url:c.common.defaultUrl,title:c.common.defaultTitle,description:c.common.defaultDescription},o)},setUpConfigOptions:function(){c.common.defaultTitle=this.pageManager.getMeta("og:title")||document.title,c.common.defaultDescription=this.pageManager.getMeta("description")||""},isMobileSharetools:function(){return this.pageManager.getCurrentBreakpoint()<1e3},openMailToLink:function(){var e="%0A%0A",t=encodeURIComponent(this.settings.title),i=encodeURIComponent(this.settings.description),a=encodeURIComponent(this.settings.url),n="NYTimes.com: "+t,s="From The New York Times:"+e+t+e+i+e+a;window.location="mailto:?subject="+n+"&body="+s},handleShortUrlShareAction:function(t,i){var a,n,s,o=this,r=i||this.settings.url,l=this.createAnchor(r);return/(?:iPad|iPhone)/.test(navigator.userAgent)?(s=e("#masthead").find(".story-short-url").text()||this.pageManager.getCanonical()||r,a=t.postUrl+"?url="+encodeURIComponent(s)+"&text="+encodeURIComponent(document.title),void window.open(a,t.label+"Share","toolbar=0,status=0,height="+t.height+",width="+t.width+",scrollbars=yes,resizable=yes")):(n=window.open("",t.label+"Share","toolbar=0,status=0,height="+t.height+",width="+t.width+",scrollbars=yes,resizable=yes"),t.smid&&!this.pageManager.isMobile()&&(l.search+=0===l.search.indexOf("?")?"&":"?",l.search+="smid="+t.smid,r=l.href),a=u.requestUrl(r)||"",a?this.shortUrlRedirect(a,t,n):this.listenToOnce(u,"add",function(){var e=u.findWhere({url:r});e&&o.shortUrlRedirect(e.get("shortUrl"),t,n)}),void(navigator.userAgent.match(/iPad/i)&&navigator.userAgent.match(/Safari/i)&&this.shortUrlRedirect(e("#masthead").find(".story-short-url").text(),t,n)))},shortUrlRedirect:function(i,a,n){var s,o,r=[],l=t.extend({},this.settings);a.shareParameters&&l&&e.each(a.shareParameters,function(e,t){s="url"===e?i:l[e],s&&r.push(t+"="+encodeURIComponent(s))}),r=r.join("&"),o=a.postUrl+this.paramChar(a.postUrl)+r,this.shoveUrlToNewWindow(o,n)},shoveUrlToNewWindow:function(e,t){t.document.location=e,t.document.close()},itemSaved:function(){l.get("sharetools_hasSaves")!==!0?(this.firstTimeSaveModal(),l.set("sharetools_hasSaves",!0)):this.growlSaveModal()},growlSaveModal:function(){var e=new o({id:"save-item-growl-modal",modalTitle:'<i class="icon"></i>Saved',tailDirection:"centered",openCallback:function(){window.setTimeout(this.removeFromPage,2e3)}}).addToPage();t.defer(e.open)},firstTimeSaveModal:function(){var e=new o({id:"save-item-modal",modalTitle:'<i class="icon"></i>Saved',modalContent:a.savemodal({link:d.www+"/saved"}),hasOverlay:!0,hasCloseButton:!0,tailDirection:"centered",closeCallback:function(){this.removeFromPage()}}).addToPage();t.defer(e.open)},saveAction:function(){var e=r.where({url:this.settings.url});return h.isLoggedIn()?void(0===e.length?(this.subscribeOnce(r,"nyt:xps-saved",this.itemSaved),r.save(this.settings.url)):this.growlSaveModal()):(this.trackingTrigger("loginmodal-open",{module:"LogIn",action:"Click",region:"ToolsMenu",eventName:"ArticleTool-save"}),!0)},paramChar:function(e){return-1!==e.indexOf("?")?"&":"?"},buildUrl:function(i,a){var n,s,o,r=c.tools[i],l=[],d=r.postUrl,h=t.extend({},a||this.settings);return s=u.getRicoUrl(h.url),s&&"email"!==i&&(h.url=s),o=this.createAnchor(h.url),r.smid&&(o.search+=0===o.search.indexOf("?")?"&":"?",o.search+="smid="+r.smid,h.url=o.href),r.shareParameters&&h&&e.each(r.shareParameters,function(e,t){n=h[e],l.push(t+"="+encodeURIComponent(n))}),r.urlParameters&&e.each(r.urlParameters,function(e,t){null!==t&&l.push(e+"="+encodeURIComponent(t))}),l=l.join("&"),d=d+this.paramChar(d)+l},popupShareAction:function(e,t){var i=c.tools[e],a=i.width?i.width:c.common.defaultWidth,n=i.height?i.height:c.common.defaultHeight,s=this.buildUrl(e,t);window.open(s,e+"Share","toolbar=0,status=0,height="+n+",width="+a+",scrollbars=yes,resizable=yes")}};return m}),define("shared/sharetools/views/showall",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/modal/views/modal","shared/ad/views/ads","shared/sharetools/templates","shared/sharetools/helpers/sharetools-config","shared/sharetools/helpers/sharetools-mixin","shared/sharetools/views/email","foundation/models/user-data","shared/sharetools/instances/short-url"],function(e,t,i,a,n,s,o,r,l,d,h){"use strict";var c=i.extend(t.extend({},r,{events:{"click .sharetool":"handleLinkClick","click .short-url-input, .text":"handleInputSelect"},className:"show-all-view-container",defaultModalSettings:{id:"show-all-sharetool-modal",modalTitle:"share this video",binding:".show-all-sharetool",tailDirection:"up",hasOverlay:!1,hasCloseButton:!1,positionTailSide:!1,autoPosition:!1,modalContent:"",tailLeftOffset:0,tailTopOffset:0,template:"showAllSharetoolModal",openCallback:function(){this.$target.addClass("active")},closeCallback:function(){this.$target.removeClass("active"),this.removeFromPage()}},articleTools:["save","print","reprints"],initialize:function(e,i){var a;t.bindAll(this,"handleShortUrl"),this.settings=t.extend({},this.getDataAttrs(!0,i)),this.modalSettings=t.extend({},this.defaultModalSettings,e),this.isMobileSharetools()&&(this.modalSettings=t.extend({},this.modalSettings,{tailDirection:"centered",hasCloseButton:!0,hasOverlay:!0,positionTailSide:!1,autoPosition:!1})),a=this.createAnchor(this.settings.url),a.search+=0===a.search.indexOf("?")?"&":"?",a.search+="smid=pl-share",this.settings.permalinkUrlWithSmid=a.href,this.settings.shortUrl=h.requestUrl(this.settings.permalinkUrlWithSmid)||"",this.settings.shortUrl||this.listenToOnce(h,"add",this.handleShortUrl),this.render(),this.trackingBaseData={module:"ShareTools",action:"click",contentCollection:this.pageManager.getMeta("article:section")}},render:function(){var e=this.settings.ad?"Frame6A":"";this.modalSettings.modalContent=s[this.modalSettings.template](this.buildShareHTML()),this.modalSettings.modalFooter=s.shareToolsModalFooter({toolTypeSponsor:"Share"}),this.showAllModal=new a(this.modalSettings),this.setElement(this.showAllModal.$modal),this.showAllModal.$modal.find(".show-all-sharetool-modal-ad").attr("id",e),this.showAllModal.addToPage(),this.settings.ad&&this.pageManager.getCurrentBreakpoint()>=1e3&&new n({positions:[e],scope:"modal",autoconfirm:0}),this.settings.embedCode&&this.handleEmbedCode(),this.settings.shortUrl&&this.handleShortUrl()},buildShareHTML:function(){var e,i,a,n=this.settings.inlineTools,r="",l="";for(e=0,i=n.length;i>e;e+=1)a=s.showallLinks({shareObj:n[e],config:o.tools[n[e].type]}),t.indexOf(this.articleTools,n[e].type)>=0?l+=a:r+=a;return{shortUrl:this.settings.shortUrl,showAllLinkList:r,showAllToolList:l}},handleShortUrl:function(){var e=h.findWhere({url:this.settings.permalinkUrlWithSmid});e&&(this.settings.shortUrl=e.get("shortUrl"),this.showAllModal.$modal.find(".short-url-input").val(this.settings.shortUrl))},handleEmbedCode:function(){this.settings.embedCode&&this.showAllModal.$modal.find(".embed-input").val(this.settings.embedCode)},handleInputSelect:function(e){e.target.select()},handleLinkClick:function(t){var i=e(t.target),a=i.data("share")||i.parent().data("share"),n="popup"===o.tools[a].postType?"popup":a,s={version:this.settings.contentType||"Content",region:"ToolsMenu"};switch(this.showAllModal.close(),"save"===a||"reprints"===a||"print"===a?(s.module="ArticleTools",s.eventName="ArticleTool-"+a):s.eventName="Share-"+a,this.trackingTrigger("share-tools-click",s),n){case"email":this.isMobileSharetools()?this.openMailToLink():d.isLoggedIn()&&new l({dataUrl:this.settings.url});break;case"popup":"twitter"===a?this.handleShortUrlShareAction(o.tools[a]):this.popupShareAction(a);break;case"save":this.saveAction();break;case"reprints":this.popupShareAction(a);break;case"print":window.print()}}}));return c}),define("shared/sharetools/views/sharetools",["jquery/nyt","underscore/nyt","foundation/views/base-view","shared/sharetools/templates","shared/sharetools/views/email","shared/sharetools/views/showall","shared/sharetools/instances/cross-platform-save","foundation/models/user-data","shared/sharetools/helpers/sharetools-config","shared/sharetools/helpers/sharetools-mixin"],function(e,t,i,a,n,s,o,r,l,d){"use strict";var h=i.registerView("sharetools").extend(t.extend({},d,{events:{"click .sharetool":"handleShareAction"},defaultModalData:{shares:"facebook|Share,email|Email,twitter|Tweet,linkedin|LinkedIn,google|Google+,reddit|Reddit,save|Save,reprints|Reprints,print|Print,ad"},initialize:function(e){0===this.$el.length||this.$el.hasClass("sharetools-init")||(this.settings=t.extend({},this.getDataAttrs(),e),this.modalSettings=t.extend({},e.showAllModalSettings),this.modalData=t.extend({},this.$el.data(),this.defaultModalData,e.showAllModalData),this.$el.addClass("sharetools"),this.setUpConfigOptions(),this.render(),this.trackingBaseData={module:"ShareTools",version:this.$el.data("content-type")||"Content",action:"click",contentCollection:this.pageManager.getMeta("article:section"),pgtype:this.pageManager.getMeta("PT")})},render:function(){var t,i=this.$el.find(".sharetools-inline-article-ad"),n=a.shareTools({shares:this.settings.inlineTools,config:l.tools});return this.$el.addClass("sharetools-init"),i.length>0?e(n).insertBefore(this.$el.find(".sharetools-inline-article-ad")):this.$el.append(n),this.settings.ad&&(t=this.pageManager.getCurrentBreakpoint()<=1020?"Position1":"Frame4A",this.$el.find(".sharetools-inline-article-ad").attr("id",t),this.broadcast("nyt:ads-new-placement",t)),this},handleShareAction:function(t){var i=e(t.target),a=i.data("share")||i.parent().data("share"),o="popup"===l.tools[a].postType?"popup":a,d=this.trackingBaseData;switch(i.parents(".video-player-region").size()>0?d.region="video-player-region":i.parents("#main").size()>0?d.region="Body":i.parents("#masthead").size()>0&&(d.region="TopBar"),"show-all"===a?d.eventName="Share-ShowAll":"save"===a||"reprints"===a||"print"===a?(d.module="ArticleTools",d.eventName="ArticleTool-"+a):d.eventName="Share-"+a,this.trackingTrigger("share-tools-click",d),o){case"email":this.isMobileSharetools()?this.openMailToLink():r.isLoggedIn()&&new n({dataUrl:this.settings.url});break;case"save":this.saveAction();break;case"popup":"twitter"===a?this.handleShortUrlShareAction(l.tools[a]):this.popupShareAction(a);break;case"embed":t.stopPropagation(),this.$(".show-all-sharetool a").trigger("click"),this.$body.find(".show-all-sharetool-modal #embed-input").select();break;case"show-all":new s(this.modalSettings,this.modalData)}},changeActiveState:function(){this.$(".show-all-sharetool").hasClass("active")?this.$(".show-all-sharetool").removeClass("active"):this.$(".show-all-sharetool").addClass("active")}}));return h}),define("paidpost/instances/sharetools",["jquery/nyt","paidpost/views/share-tools-container","shared/sharetools/views/sharetools"],function(e,t,i){"use strict";var a={trackingRegion:"Header",showAllModalData:{shares:"email|Email,facebook|Share,twitter|Tweet,pinterest|Pin,linkedin|LinkedIn,google|Google+,reddit|Reddit,tumblr|Tumblr"},showAllModalSettings:{modalTitle:"share this page",tailDirection:"centered",hasCloseButton:!0,hasOverlay:!0,positionTailSide:!1,autoPosition:!1}},n=e("#sharetools-paidpost").length?e("#sharetools-paidpost"):e(".share-tools").not(".sharetools-init").not(":has([addthis\\:url])");e("#sharetools-paidpost").length?new t({el:n}):n.each(function(){a.el=this,new i(a)})}),!function(e){var t=navigator.userAgent;e.HTMLPictureElement&&/ecko/.test(t)&&t.match(/rv\:(\d+)/)&&RegExp.$1<41&&addEventListener("resize",function(){var t,i=document.createElement("source"),a=function(e){var t,a,n=e.parentNode;"PICTURE"===n.nodeName.toUpperCase()?(t=i.cloneNode(),n.insertBefore(t,n.firstElementChild),setTimeout(function(){n.removeChild(t)})):(!e._pfLastSize||e.offsetWidth>e._pfLastSize)&&(e._pfLastSize=e.offsetWidth,a=e.sizes,e.sizes+=",100vw",setTimeout(function(){e.sizes=a}))},n=function(){var e,t=document.querySelectorAll("picture > img, img[srcset][sizes]");for(e=0;e<t.length;e++)a(t[e])},s=function(){clearTimeout(t),t=setTimeout(n,99)},o=e.matchMedia&&matchMedia("(orientation: landscape)"),r=function(){s(),o&&o.addListener&&o.addListener(s)};return i.srcset="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",/^[c|i]|d$/.test(document.readyState||"")?r():document.addEventListener("DOMContentLoaded",r),s}())}(window),function(e,t,i){"use strict";function a(e){return" "===e||"	"===e||"\n"===e||"\f"===e||"\r"===e}function n(t,i){var a=new e.Image;return a.onerror=function(){k[t]=!1,ee()},a.onload=function(){k[t]=1===a.width,ee()},a.src=i,"pending"}function s(){L=!1,j=e.devicePixelRatio,N={},B={},b.DPR=j||1,z.width=Math.max(e.innerWidth||0,T.clientWidth),z.height=Math.max(e.innerHeight||0,T.clientHeight),z.vw=z.width/100,z.vh=z.height/100,v=[z.height,z.width,j].join("-"),z.em=b.getEmValue(),z.rem=z.em}function o(e,t,i,a){var n,s,o,r;return"saveData"===A.algorithm?e>2.7?r=i+1:(s=t-i,n=Math.pow(e-.6,1.5),o=s*n,a&&(o+=.1*n),r=e+o):r=i>1?Math.sqrt(e*t):e,r>i}function r(e){var t,i=b.getSet(e),a=!1;"pending"!==i&&(a=v,i&&(t=b.setRes(i),b.applySetCandidate(t,e))),e[b.ns].evaled=a}function l(e,t){return e.res-t.res}function d(e,t,i){var a;return!i&&t&&(i=e[b.ns].sets,i=i&&i[i.length-1]),a=h(t,i),a&&(t=b.makeUrl(t),e[b.ns].curSrc=t,e[b.ns].curCan=a,a.res||Z(a,a.set.sizes)),a}function h(e,t){var i,a,n;if(e&&t)for(n=b.parseSet(t),e=b.makeUrl(e),i=0;i<n.length;i++)if(e===b.makeUrl(n[i].url)){a=n[i];break}return a}function c(e,t){var i,a,n,s,o=e.getElementsByTagName("source");for(i=0,a=o.length;a>i;i++)n=o[i],n[b.ns]=!0,s=n.getAttribute("srcset"),s&&t.push({srcset:s,media:n.getAttribute("media"),type:n.getAttribute("type"),sizes:n.getAttribute("sizes")})}function u(e,t){function i(t){var i,a=t.exec(e.substring(u));return a?(i=a[0],u+=i.length,i):void 0}function n(){var e,i,a,n,s,l,d,h,c,u=!1,p={};for(n=0;n<r.length;n++)s=r[n],l=s[s.length-1],d=s.substring(0,s.length-1),h=parseInt(d,10),c=parseFloat(d),Y.test(d)&&"w"===l?((e||i)&&(u=!0),0===h?u=!0:e=h):G.test(d)&&"x"===l?((e||i||a)&&(u=!0),0>c?u=!0:i=c):Y.test(d)&&"h"===l?((a||i)&&(u=!0),0===h?u=!0:a=h):u=!0;u||(p.url=o,e&&(p.w=e),i&&(p.d=i),a&&(p.h=a),a||i||e||(p.d=1),1===p.d&&(t.has1x=!0),p.set=t,m.push(p))}function s(){for(i(q),l="",d="in descriptor";;){if(h=e.charAt(u),"in descriptor"===d)if(a(h))l&&(r.push(l),l="",d="after descriptor");else{if(","===h)return u+=1,l&&r.push(l),void n();if("("===h)l+=h,d="in parens";else{if(""===h)return l&&r.push(l),void n();l+=h}}else if("in parens"===d)if(")"===h)l+=h,d="in descriptor";else{if(""===h)return r.push(l),void n();l+=h}else if("after descriptor"===d)if(a(h));else{if(""===h)return void n();d="in descriptor",u-=1}u+=1}}for(var o,r,l,d,h,c=e.length,u=0,m=[];;){if(i(W),u>=c)return m;o=i(V),r=[],","===o.slice(-1)?(o=o.replace(K,""),n()):s()}}function m(e){function t(e){function t(){s&&(o.push(s),s="")}function i(){o[0]&&(r.push(o),o=[])}for(var n,s="",o=[],r=[],l=0,d=0,h=!1;;){if(n=e.charAt(d),""===n)return t(),i(),r;if(h){if("*"===n&&"/"===e[d+1]){h=!1,d+=2,t();continue}d+=1}else{if(a(n)){if(e.charAt(d-1)&&a(e.charAt(d-1))||!s){d+=1;continue}if(0===l){t(),d+=1;continue}n=" "}else if("("===n)l+=1;else if(")"===n)l-=1;else{if(","===n){t(),i(),d+=1;continue}if("/"===n&&"*"===e.charAt(d+1)){h=!0,d+=2;continue}}s+=n,d+=1}}}function i(e){return h.test(e)&&parseFloat(e)>=0?!0:c.test(e)?!0:"0"===e||"-0"===e||"+0"===e?!0:!1}var n,s,o,r,l,d,h=/^(?:[+-]?[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?(?:ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmin|vmax|vw)$/i,c=/^calc\((?:[0-9a-z \.\+\-\*\/\(\)]+)\)$/i;for(s=t(e),o=s.length,n=0;o>n;n++)if(r=s[n],l=r[r.length-1],i(l)){if(d=l,r.pop(),0===r.length)return d;if(r=r.join(" "),b.matchesMedia(r))return d}return"100vw"}t.createElement("picture");var p,g,f,v,b={},y=function(){},w=t.createElement("img"),_=w.getAttribute,C=w.setAttribute,S=w.removeAttribute,T=t.documentElement,k={},A={algorithm:""},M="data-pfsrc",x=M+"set",P=navigator.userAgent,I=/rident/.test(P)||/ecko/.test(P)&&P.match(/rv\:(\d+)/)&&RegExp.$1>35,$="currentSrc",D=/\s+\+?\d+(e\d+)?w/,E=/(\([^)]+\))?\s*(.+)/,O=e.picturefillCFG,R="position:absolute;left:0;visibility:hidden;display:block;padding:0;border:none;font-size:1em;width:1em;overflow:hidden;clip:rect(0px, 0px, 0px, 0px)",U="font-size:100%!important;",L=!0,N={},B={},j=e.devicePixelRatio,z={px:1,"in":96},F=t.createElement("a"),H=!1,q=/^[ \t\n\r\u000c]+/,W=/^[, \t\n\r\u000c]+/,V=/^[^ \t\n\r\u000c]+/,K=/[,]+$/,Y=/^\d+$/,G=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,Q=function(e,t,i,a){e.addEventListener?e.addEventListener(t,i,a||!1):e.attachEvent&&e.attachEvent("on"+t,i)},X=function(e){var t={};return function(i){return i in t||(t[i]=e(i)),t[i]}},J=function(){var e=/^([\d\.]+)(em|vw|px)$/,t=function(){for(var e=arguments,t=0,i=e[0];++t in e;)i=i.replace(e[t],e[++t]);return i},i=X(function(e){return"return "+t((e||"").toLowerCase(),/\band\b/g,"&&",/,/g,"||",/min-([a-z-\s]+):/g,"e.$1>=",/max-([a-z-\s]+):/g,"e.$1<=",/calc([^)]+)/g,"($1)",/(\d+[\.]*[\d]*)([a-z]+)/g,"($1 * e.$2)",/^(?!(e.[a-z]|[0-9\.&=|><\+\-\*\(\)\/])).*/gi,"")+";"});return function(t,a){var n;if(!(t in N))if(N[t]=!1,a&&(n=t.match(e)))N[t]=n[1]*z[n[2]];else try{N[t]=new Function("e",i(t))(z)}catch(s){}return N[t]}}(),Z=function(e,t){return e.w?(e.cWidth=b.calcListLength(t||"100vw"),e.res=e.w/e.cWidth):e.res=e.d,e},ee=function(e){var i,a,n,s=e||{};if(s.elements&&1===s.elements.nodeType&&("IMG"===s.elements.nodeName.toUpperCase()?s.elements=[s.elements]:(s.context=s.elements,s.elements=null)),i=s.elements||b.qsa(s.context||t,s.reevaluate||s.reselect?b.sel:b.selShort),n=i.length){for(b.setupRun(s),H=!0,a=0;n>a;a++)b.fillImg(i[a],s);b.teardownRun(s)}};p=e.console&&console.warn?function(e){console.warn(e)}:y,$ in w||($="src"),k["image/jpeg"]=!0,k["image/gif"]=!0,k["image/png"]=!0,k["image/svg+xml"]=t.implementation.hasFeature("http://wwwindow.w3.org/TR/SVG11/feature#Image","1.1"),b.ns=("pf"+(new Date).getTime()).substr(0,9),b.supSrcset="srcset"in w,b.supSizes="sizes"in w,b.supPicture=!!e.HTMLPictureElement,b.supSrcset&&b.supPicture&&!b.supSizes&&!function(e){w.srcset="data:,a",e.src="data:,a",b.supSrcset=w.complete===e.complete,b.supPicture=b.supSrcset&&b.supPicture}(t.createElement("img")),b.selShort="picture>img,img[srcset]",b.sel=b.selShort,b.cfg=A,b.supSrcset&&(b.sel+=",img["+x+"]"),b.DPR=j||1,b.u=z,b.types=k,f=b.supSrcset&&!b.supSizes,b.setSize=y,b.makeUrl=X(function(e){return F.href=e,F.href}),b.qsa=function(e,t){return e.querySelectorAll(t)},b.matchesMedia=function(){return e.matchMedia&&(matchMedia("(min-width: 0.1em)")||{}).matches?b.matchesMedia=function(e){return!e||matchMedia(e).matches}:b.matchesMedia=b.mMQ,b.matchesMedia.apply(this,arguments)},b.mMQ=function(e){return e?J(e):!0},b.calcLength=function(e){var t=J(e,!0)||!1;return 0>t&&(t=!1),t},b.supportsType=function(e){return e?k[e]:!0},b.parseSize=X(function(e){var t=(e||"").match(E);return{media:t&&t[1],length:t&&t[2]}}),b.parseSet=function(e){return e.cands||(e.cands=u(e.srcset,e)),e.cands},b.getEmValue=function(){var e;if(!g&&(e=t.body)){var i=t.createElement("div"),a=T.style.cssText,n=e.style.cssText;i.style.cssText=R,T.style.cssText=U,e.style.cssText=U,e.appendChild(i),g=i.offsetWidth,e.removeChild(i),g=parseFloat(g,10),T.style.cssText=a,e.style.cssText=n}return g||16},b.calcListLength=function(e){if(!(e in B)||A.uT){var t=b.calcLength(m(e));B[e]=t?t:z.width}return B[e]},b.setRes=function(e){var t;if(e){t=b.parseSet(e);for(var i=0,a=t.length;a>i;i++)Z(t[i],e.sizes)}return t},b.setRes.res=Z,b.applySetCandidate=function(e,t){if(e.length){var i,a,n,s,r,h,c,u,m,p=t[b.ns],g=b.DPR;if(h=p.curSrc||t[$],c=p.curCan||d(t,h,e[0].set),c&&c.set===e[0].set&&(m=I&&!t.complete&&c.res-.1>g,m||(c.cached=!0,c.res>=g&&(r=c))),!r)for(e.sort(l),s=e.length,r=e[s-1],a=0;s>a;a++)if(i=e[a],i.res>=g){n=a-1,r=e[n]&&(m||h!==b.makeUrl(i.url))&&o(e[n].res,i.res,g,e[n].cached)?e[n]:i;break}r&&(u=b.makeUrl(r.url),p.curSrc=u,p.curCan=r,u!==h&&b.setSrc(t,r),b.setSize(t))}},b.setSrc=function(e,t){var i;e.src=t.url,"image/svg+xml"===t.set.type&&(i=e.style.width,e.style.width=e.offsetWidth+1+"px",e.offsetWidth+1&&(e.style.width=i));
},b.getSet=function(e){var t,i,a,n=!1,s=e[b.ns].sets;for(t=0;t<s.length&&!n;t++)if(i=s[t],i.srcset&&b.matchesMedia(i.media)&&(a=b.supportsType(i.type))){"pending"===a&&(i=a),n=i;break}return n},b.parseSets=function(e,t,a){var n,s,o,r,l=t&&"PICTURE"===t.nodeName.toUpperCase(),d=e[b.ns];(d.src===i||a.src)&&(d.src=_.call(e,"src"),d.src?C.call(e,M,d.src):S.call(e,M)),(d.srcset===i||a.srcset||!b.supSrcset||e.srcset)&&(n=_.call(e,"srcset"),d.srcset=n,r=!0),d.sets=[],l&&(d.pic=!0,c(t,d.sets)),d.srcset?(s={srcset:d.srcset,sizes:_.call(e,"sizes")},d.sets.push(s),o=(f||d.src)&&D.test(d.srcset||""),o||!d.src||h(d.src,s)||s.has1x||(s.srcset+=", "+d.src,s.cands.push({url:d.src,d:1,set:s}))):d.src&&d.sets.push({srcset:d.src,sizes:null}),d.curCan=null,d.curSrc=i,d.supported=!(l||s&&!b.supSrcset||o),r&&b.supSrcset&&!d.supported&&(n?(C.call(e,x,n),e.srcset=""):S.call(e,x)),d.supported&&!d.srcset&&(!d.src&&e.src||e.src!==b.makeUrl(d.src))&&(null===d.src?e.removeAttribute("src"):e.src=d.src),d.parsed=!0},b.fillImg=function(e,t){var i,a=t.reselect||t.reevaluate;e[b.ns]||(e[b.ns]={}),i=e[b.ns],(a||i.evaled!==v)&&((!i.parsed||t.reevaluate)&&b.parseSets(e,e.parentNode,t),i.supported?i.evaled=v:r(e))},b.setupRun=function(){(!H||L||j!==e.devicePixelRatio)&&s()},b.supPicture?(ee=y,b.fillImg=y):!function(){var i,a=e.attachEvent?/d$|^c/:/d$|^c|^i/,n=function(){var e=t.readyState||"";s=setTimeout(n,"loading"===e?200:999),t.body&&(b.fillImgs(),i=i||a.test(e),i&&clearTimeout(s))},s=setTimeout(n,t.body?9:99),o=function(e,t){var i,a,n=function(){var s=new Date-a;t>s?i=setTimeout(n,t-s):(i=null,e())};return function(){a=new Date,i||(i=setTimeout(n,t))}},r=T.clientHeight,l=function(){L=Math.max(e.innerWidth||0,T.clientWidth)!==z.width||T.clientHeight!==r,r=T.clientHeight,L&&b.fillImgs()};Q(e,"resize",o(l,99)),Q(t,"readystatechange",n)}(),b.picturefill=ee,b.fillImgs=ee,b.teardownRun=y,ee._=b,e.picturefillCFG={pf:b,push:function(e){var t=e.shift();"function"==typeof b[t]?b[t].apply(b,e):(A[t]=e[0],H&&b.fillImgs({reselect:!0}))}};for(;O&&O.length;)e.picturefillCFG.push(O.shift());e.picturefill=ee,"object"==typeof module&&"object"==typeof module.exports?module.exports=ee:"function"==typeof define&&define.amd&&define("picturefill",[],function(){return ee}),b.supPicture||(k["image/webp"]=n("image/webp","data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA=="))}(window,document),define("paidpost/instances/slideshow",["jquery/nyt"],function(e){"use strict";var t="[data-nytpi][data-slick]";document.querySelectorAll(t).length&&require(["paidpost/views/slideshow"],function(i){new i({el:e(t)})})}),require(["shared/masthead/instances/masthead","shared/account/instances/account","shared/navigation/instances/navigation","paidpost/instances/sharetools","paidpost/lib/picturefill/3.0.2.min","paidpost/instances/slideshow"]);
//# sourceMappingURL=main.js.map